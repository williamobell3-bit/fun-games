<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, maximum-scale=1.0">
<title>Fun Games ‚Äî 20 Mini Games</title>
<meta name="description" content="Play 20 free mini games: Chess, Tetris, Pong, Snake, Uno, and more!">
<meta name="theme-color" content="#0a0a1a">
<link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üéÆ</text></svg>">
<style>
*{margin:0;padding:0;box-sizing:border-box}
html,body,#root{width:100%;min-height:100vh;background:#0a0a1a;overflow-x:hidden}
body{font-family:'Segoe UI',system-ui,-apple-system,sans-serif;-webkit-font-smoothing:antialiased}
::-webkit-scrollbar{width:6px}::-webkit-scrollbar-track{background:transparent}::-webkit-scrollbar-thumb{background:rgba(255,255,255,0.1);border-radius:3px}
button{font-family:inherit}canvas{display:block}
@keyframes fadeIn{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}
@keyframes pulse{0%,100%{transform:scale(1)}50%{transform:scale(1.04)}}
</style>
</head>
<body>
<div id="root"></div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.9/babel.min.js"></script>
<script type="text/plain" id="jsx-source">
const{useState,useEffect,useRef,useCallback}=React;

// ==================== AUDIO ====================
const Au=(()=>{let c=null;const g=()=>{try{if(!c)c=new(window.AudioContext||window.webkitAudioContext)();if(c.state==="suspended")c.resume();return c}catch(e){return null}};
const p=(f,d=0.1,t="square",v=0.15)=>{try{const x=g();if(!x)return;const o=x.createOscillator(),gn=x.createGain();o.type=t;o.frequency.value=f;gn.gain.setValueAtTime(v,x.currentTime);gn.gain.exponentialRampToValueAtTime(0.001,x.currentTime+d);o.connect(gn);gn.connect(x.destination);o.start();o.stop(x.currentTime+d)}catch(e){}};
return{click:()=>p(800,0.05,"sine",0.1),place:()=>p(600,0.08,"triangle",0.12),score:()=>{p(523,0.1,"sine",0.15);setTimeout(()=>p(659,0.1,"sine",0.15),80);setTimeout(()=>p(784,0.15,"sine",0.15),160)},hit:()=>p(200,0.15,"sawtooth",0.1),lose:()=>{p(400,0.2,"sawtooth",0.12);setTimeout(()=>p(300,0.2,"sawtooth",0.12),150);setTimeout(()=>p(200,0.3,"sawtooth",0.12),300)},win:()=>{[523,587,659,698,784].forEach((f,i)=>setTimeout(()=>p(f,0.15,"sine",0.15),i*100))},bounce:()=>p(440+Math.random()*200,0.06,"sine",0.08),merge:()=>{p(400,0.15,"sine",0.12);setTimeout(()=>p(600,0.15,"sine",0.12),60)},swing:()=>p(150,0.2,"sawtooth",0.15),flip:()=>p(1000,0.04,"sine",0.1)}})();

function dRR(c,x,y,w,h,r){c.beginPath();c.moveTo(x+r,y);c.lineTo(x+w-r,y);c.arcTo(x+w,y,x+w,y+r,r);c.lineTo(x+w,y+h-r);c.arcTo(x+w,y+h,x+w-r,y+h,r);c.lineTo(x+r,y+h);c.arcTo(x,y+h,x,y+h-r,r);c.lineTo(x,y+r);c.arcTo(x,y,x+r,y,r);c.closePath()}

// ==================== DATA ====================
const GM=[{id:"mancala",name:"Mancala",icon:"ü´ò",cat:"Board",desc:"Ancient stone strategy",hd:1},{id:"chess",name:"Chess",icon:"‚ôüÔ∏è",cat:"Board",desc:"Battle of minds",hd:1},{id:"checkers",name:"Checkers",icon:"üî¥",cat:"Board",desc:"Jump & capture",hd:1},{id:"backgammon",name:"Backgammon",icon:"üé≤",cat:"Board",desc:"Race pieces home",hd:0},{id:"tictactoe",name:"Tic Tac Toe",icon:"‚ùå",cat:"Board",desc:"Classic 3√ó3",hd:1},{id:"tictacgo",name:"Tic Tac Go",icon:"‚≠ï",cat:"Board",desc:"5-in-a-row",hd:0},{id:"tetris",name:"Tetris",icon:"üü¶",cat:"Arcade",desc:"Stack & clear",hd:1},{id:"snake",name:"Snake",icon:"üêç",cat:"Arcade",desc:"Eat smaller snakes",hd:1},{id:"pong",name:"Pong",icon:"üèì",cat:"Arcade",desc:"Classic paddle",hd:1},{id:"pingpong",name:"Ping Pong",icon:"üè∏",cat:"Arcade",desc:"Table tennis",hd:1},{id:"pinball",name:"Pinball",icon:"üîÆ",cat:"Arcade",desc:"Flipper madness",hd:1},{id:"blockblast",name:"Block Blast",icon:"üí•",cat:"Puzzle",desc:"Fill lines on grid",hd:1},{id:"bolts",name:"Bolts",icon:"üî©",cat:"Puzzle",desc:"Sort bolts",hd:1},{id:"colorlines",name:"Color Lines",icon:"üåà",cat:"Puzzle",desc:"Connect dots",hd:1},{id:"bingo",name:"Bingo",icon:"üé±",cat:"Puzzle",desc:"Match numbers",hd:1},{id:"fall",name:"Fall",icon:"‚öΩ",cat:"Action",desc:"Guide ball down",hd:1},{id:"drop",name:"Drop",icon:"üçâ",cat:"Action",desc:"Merge fruits",hd:1},{id:"jump",name:"Jump",icon:"ü¶ò",cat:"Action",desc:"Platform climber",hd:1},{id:"baseball",name:"Baseball",icon:"‚öæ",cat:"Action",desc:"Swing for fences",hd:1},{id:"uno",name:"Uno",icon:"üÉè",cat:"Board",desc:"4-player card game",hd:0}];
const CATS=["Board","Arcade","Puzzle","Action"];
const CC={Board:"#e8b84b",Arcade:"#e85d75",Puzzle:"#5db8e8",Action:"#5de870"};
const CI={Board:"‚ôüÔ∏è",Arcade:"üëæ",Puzzle:"üß©",Action:"‚ö°"};
const DC={easy:"#6bcb77",medium:"#ffd93d",hard:"#ff6b6b"};

// ==================== SHARED COMPONENTS ====================
function DiffSelect({game,onSelect,onBack}){const[h,sH]=useState(null);const gm=GM.find(g=>g.id===game);return(
<div style={{minHeight:"100vh",background:"linear-gradient(160deg,#0a0a1a 0%,#12082a 40%,#0a1420 100%)",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:20}}>
  <button onClick={onBack} style={{position:"absolute",top:16,left:16,background:"rgba(255,255,255,0.08)",border:"1px solid rgba(255,255,255,0.1)",color:"#aaa",padding:"10px 20px",borderRadius:10,cursor:"pointer",fontWeight:600}}>‚Üê Back</button>
  <div style={{textAlign:"center",marginBottom:40,animation:"fadeIn 0.4s ease"}}><div style={{fontSize:"4rem",marginBottom:8}}>{gm?.icon}</div><h1 style={{color:"#fff",fontSize:"2.2rem",fontWeight:900,margin:"0 0 6px"}}>{gm?.name}</h1><p style={{color:"#667",margin:0}}>{gm?.desc}</p></div>
  <p style={{color:"#889",fontSize:"0.9rem",fontWeight:600,textTransform:"uppercase",letterSpacing:3,marginBottom:20}}>Select Difficulty</p>
  <div style={{display:"flex",gap:16,flexWrap:"wrap",justifyContent:"center"}}>
    {["easy","medium","hard"].map(d=><button key={d} onClick={()=>{Au.click();onSelect(d)}} onMouseEnter={()=>sH(d)} onMouseLeave={()=>sH(null)} style={{width:180,padding:"28px 20px",borderRadius:20,background:h===d?DC[d]+"22":"rgba(255,255,255,0.04)",border:`2px solid ${h===d?DC[d]:"rgba(255,255,255,0.08)"}`,cursor:"pointer",transition:"all 0.25s",transform:h===d?"translateY(-6px) scale(1.03)":"translateY(0)",boxShadow:h===d?`0 12px 40px ${DC[d]}25`:"none"}}>
      <div style={{fontSize:"2rem",marginBottom:8}}>{d==="easy"?"üòä":d==="medium"?"üò§":"üíÄ"}</div>
      <div style={{color:DC[d],fontWeight:800,fontSize:"1.15rem",marginBottom:4}}>{d==="easy"?"Easy":d==="medium"?"Medium":"Hard"}</div>
      <div style={{color:"#778",fontSize:"0.78rem"}}>{d==="easy"?"Relaxed pace":d==="medium"?"Fair challenge":"Ruthless AI"}</div>
    </button>)}
  </div>
</div>)}

function Menu({onSelect}){const[f,sF]=useState("All");const[h,sH]=useState(null);const[q,sQ]=useState("");const gs=GM.filter(g=>(f==="All"||g.cat===f)&&(!q||g.name.toLowerCase().includes(q.toLowerCase())));return(
<div style={{minHeight:"100vh",background:"linear-gradient(160deg,#0a0a1a 0%,#12082a 40%,#0a1420 100%)",padding:20}}>
  <div style={{textAlign:"center",padding:"36px 0 24px"}}>
    <h1 style={{fontSize:"3.2rem",margin:0,fontWeight:900,letterSpacing:3}}><span style={{background:"linear-gradient(135deg,#ff6b6b 0%,#ffd93d 25%,#6bcb77 50%,#4d96ff 75%,#a855f7 100%)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent"}}>FUN GAMES</span></h1>
    <div style={{fontSize:"0.75rem",color:"#556",fontWeight:600,letterSpacing:6,textTransform:"uppercase",marginTop:4}}>20 Games ‚Äî Free to Play</div>
    <div style={{maxWidth:320,margin:"20px auto 16px",position:"relative"}}><input value={q} onChange={e=>sQ(e.target.value)} placeholder="Search games..." style={{width:"100%",padding:"12px 16px 12px 40px",borderRadius:14,border:"1px solid rgba(255,255,255,0.08)",background:"rgba(255,255,255,0.04)",color:"#fff",fontSize:"0.95rem",outline:"none",boxSizing:"border-box"}}/><span style={{position:"absolute",left:14,top:"50%",transform:"translateY(-50%)",color:"#556"}}>üîç</span></div>
    <div style={{display:"flex",gap:8,justifyContent:"center",flexWrap:"wrap"}}>{["All",...CATS].map(c=><button key={c} onClick={()=>{sF(c);Au.click()}} style={{padding:"9px 20px",borderRadius:24,border:f===c?"none":"1px solid rgba(255,255,255,0.08)",background:f===c?(c==="All"?"rgba(255,255,255,0.95)":CC[c]):"rgba(255,255,255,0.04)",color:f===c?"#000":"#999",cursor:"pointer",fontWeight:700,fontSize:"0.85rem",transition:"all 0.2s"}}>{c!=="All"&&<span style={{marginRight:4}}>{CI[c]}</span>}{c}</button>)}</div>
  </div>
  <div style={{display:"grid",gridTemplateColumns:"repeat(auto-fill,minmax(155px,1fr))",gap:12,maxWidth:960,margin:"0 auto",padding:"8px 0 50px"}}>
    {gs.map((g,i)=><button key={g.id} onClick={()=>{Au.click();onSelect(g.id)}} onMouseEnter={()=>sH(g.id)} onMouseLeave={()=>sH(null)} style={{background:h===g.id?"rgba(255,255,255,0.1)":"rgba(255,255,255,0.04)",border:`1px solid ${h===g.id?CC[g.cat]+"55":"rgba(255,255,255,0.06)"}`,borderRadius:18,padding:"22px 14px 18px",cursor:"pointer",textAlign:"center",transition:"all 0.25s",display:"flex",flexDirection:"column",alignItems:"center",gap:5,transform:h===g.id?"translateY(-5px)":"translateY(0)",animation:`fadeIn 0.35s ease ${i*0.03}s both`}}><span style={{fontSize:"2.4rem"}}>{g.icon}</span><span style={{color:"#fff",fontWeight:800,fontSize:"0.9rem"}}>{g.name}</span><span style={{color:CC[g.cat],fontSize:"0.65rem",fontWeight:700,textTransform:"uppercase",letterSpacing:1.5}}>{g.cat}</span><span style={{color:"#556",fontSize:"0.72rem"}}>{g.desc}</span></button>)}
  </div>
</div>)}

function GW({title,onBack,children,bg="#0a0a1a",score}){return(
<div style={{minHeight:"100vh",background:bg,color:"#fff"}}>
  <div style={{display:"flex",alignItems:"center",padding:"8px 14px",gap:10,background:"rgba(0,0,0,0.4)",backdropFilter:"blur(10px)",borderBottom:"1px solid rgba(255,255,255,0.06)",position:"sticky",top:0,zIndex:100}}>
    <button onClick={()=>{Au.click();onBack()}} style={{background:"rgba(255,255,255,0.08)",border:"1px solid rgba(255,255,255,0.1)",color:"#ccc",padding:"8px 16px",borderRadius:10,cursor:"pointer",fontWeight:700}}>‚Üê Menu</button>
    <h2 style={{margin:0,fontSize:"1.1rem",fontWeight:800,flex:1}}>{title}</h2>
    {score!==undefined&&<div style={{background:"rgba(255,255,255,0.08)",padding:"6px 14px",borderRadius:10,fontWeight:800,fontVariantNumeric:"tabular-nums"}}>{score}</div>}
  </div>
  <div style={{padding:10}}>{children}</div>
</div>)}

const Btn=({children,onClick,color="rgba(255,255,255,0.1)",textColor="#fff",size="md",...p})=><button onClick={e=>{Au.click();onClick?.(e)}} style={{padding:size==="lg"?"14px 36px":"10px 24px",borderRadius:12,border:"none",background:color,color:textColor,fontWeight:700,cursor:"pointer",fontSize:size==="lg"?"1.1rem":"0.95rem",transition:"all 0.15s"}} {...p}>{children}</button>;
const CB=({children,onClick})=><button onClick={e=>{Au.click();onClick?.(e)}} style={{width:54,height:54,borderRadius:14,fontSize:"1.5rem",display:"flex",alignItems:"center",justifyContent:"center",background:"rgba(255,255,255,0.1)",border:"none",color:"#fff",cursor:"pointer",fontWeight:700}}>{children}</button>;
const GO=({score,onReset,message})=><div style={{position:"absolute",inset:0,background:"rgba(0,0,0,0.85)",backdropFilter:"blur(6px)",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",zIndex:50,animation:"fadeIn 0.3s",borderRadius:12}}><div style={{fontSize:"2.5rem",marginBottom:8}}>üíÄ</div><div style={{fontSize:"1.8rem",fontWeight:900,marginBottom:4}}>Game Over</div>{message&&<div style={{color:"#aaa",marginBottom:8}}>{message}</div>}<div style={{fontSize:"1.2rem",fontWeight:700,color:"#ffd93d",marginBottom:20}}>Score: {score}</div><Btn onClick={onReset} color="#4d96ff" size="lg">Play Again</Btn></div>;
const WN=({message,onReset})=><div style={{position:"absolute",inset:0,background:"rgba(0,0,0,0.85)",backdropFilter:"blur(6px)",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",zIndex:50,animation:"fadeIn 0.3s",borderRadius:12}}><div style={{fontSize:"3rem",marginBottom:8}}>üéâ</div><div style={{fontSize:"1.8rem",fontWeight:900,color:"#6bcb77",marginBottom:16}}>{message||"You Win!"}</div><Btn onClick={onReset} color="#6bcb77" textColor="#000" size="lg">Play Again</Btn></div>;

// ==================== TIC TAC TOE ====================
function TicTacToe({onBack,difficulty}){const[b,sB]=useState(Array(9).fill(null));const[st,sSt]=useState("Your turn (X)");const[w,sW]=useState(null);const[wl,sWL]=useState(null);const wins=[[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]];const ck=b2=>{for(let w of wins)if(b2[w[0]]&&b2[w[0]]===b2[w[1]]&&b2[w[1]]===b2[w[2]])return{w:b2[w[0]],l:w};return b2.includes(null)?null:{w:"D"}};const ai=b2=>{const e=b2.map((v,i)=>v===null?i:-1).filter(i=>i>=0);if(difficulty==="easy"&&Math.random()<0.6)return e[Math.floor(Math.random()*e.length)];for(let i of e){const t=[...b2];t[i]="O";if(ck(t)?.w==="O")return i}for(let i of e){const t=[...b2];t[i]="X";if(ck(t)?.w==="X")return i}if(difficulty==="medium"&&Math.random()<0.25)return e[Math.floor(Math.random()*e.length)];if(b2[4]===null)return 4;const c=[0,2,6,8].filter(i=>b2[i]===null);return c.length?c[Math.floor(Math.random()*c.length)]:e[Math.floor(Math.random()*e.length)]};const cl=i=>{if(b[i]||w)return;Au.place();const nb=[...b];nb[i]="X";const r=ck(nb);if(r){sB(nb);sW(r.w);sWL(r.l);sSt(r.w==="X"?"You win! üéâ":"Draw!");if(r.w==="X")Au.win();return}const a=ai(nb);if(a===undefined)return;nb[a]="O";const r2=ck(nb);sB(nb);if(r2){sW(r2.w);sWL(r2.l);sSt(r2.w==="O"?"AI wins!":"Draw!");if(r2.w==="O")Au.lose()}else sSt("Your turn (X)")};const rs=()=>{sB(Array(9).fill(null));sSt("Your turn (X)");sW(null);sWL(null)};return(<GW title="Tic Tac Toe" onBack={onBack}><div style={{display:"flex",flexDirection:"column",alignItems:"center",gap:16,paddingTop:30}}><p style={{fontSize:"1.15rem",fontWeight:700,color:w==="X"?"#6bcb77":w==="O"?"#ff6b6b":"#ccc"}}>{st}</p><div style={{display:"grid",gridTemplateColumns:"repeat(3,88px)",gap:8}}>{b.map((v,i)=><button key={i} onClick={()=>cl(i)} style={{width:88,height:88,fontSize:"2.8rem",fontWeight:900,background:wl?.includes(i)?"rgba(107,203,119,0.2)":"rgba(255,255,255,0.06)",border:`2px solid ${wl?.includes(i)?"#6bcb77":"rgba(255,255,255,0.1)"}`,borderRadius:16,color:v==="X"?"#ff6b6b":"#4d96ff",cursor:"pointer"}}>{v}</button>)}</div><Btn onClick={rs} color="#4d96ff">New Game</Btn></div></GW>)}

// ==================== TIC TAC GO ====================
function TicTacGo({onBack}){const S=13;const[b,sB]=useState(Array(S*S).fill(null));const[xt,sXT]=useState(true);const[w,sW]=useState(null);const c5=(b2,r,c,dr,dc)=>{const v=b2[r*S+c];if(!v)return null;for(let i=1;i<5;i++){const nr=r+dr*i,nc=c+dc*i;if(nr<0||nr>=S||nc<0||nc>=S||b2[nr*S+nc]!==v)return null}return v};const cW=b2=>{for(let r=0;r<S;r++)for(let c=0;c<S;c++)for(let[dr,dc]of[[0,1],[1,0],[1,1],[1,-1]]){const v=c5(b2,r,c,dr,dc);if(v)return v}return null};const cl=i=>{if(b[i]||w)return;Au.place();const nb=[...b];nb[i]=xt?"X":"O";sB(nb);const r=cW(nb);if(r){sW(r);Au.win()}sXT(!xt)};return(<GW title="Tic Tac Go" onBack={onBack}><div style={{display:"flex",flexDirection:"column",alignItems:"center",gap:10}}><p style={{fontWeight:700,color:w?"#6bcb77":"#ccc"}}>{w?w+" wins!":(xt?"X":"O")+"'s turn"}</p><div style={{display:"grid",gridTemplateColumns:`repeat(${S},28px)`,gap:1,background:"rgba(255,255,255,0.05)",padding:3,borderRadius:8,overflow:"auto",maxWidth:"95vw"}}>{b.map((v,i)=><button key={i} onClick={()=>cl(i)} style={{width:28,height:28,fontSize:"0.7rem",fontWeight:900,background:v?"rgba(255,255,255,0.08)":"rgba(0,0,0,0.3)",border:"none",color:v==="X"?"#ff6b6b":"#4d96ff",cursor:"pointer",borderRadius:2}}>{v}</button>)}</div><Btn onClick={()=>{sB(Array(S*S).fill(null));sXT(true);sW(null)}} color="#4d96ff">Reset</Btn><p style={{color:"#556",fontSize:"0.8rem"}}>2-player: 5 in a row</p></div></GW>)}

// ==================== CANVAS GAME WRAPPER ====================
function CVG({onBack,title,bg,difficulty,hint,setup}){const ref=useRef(null);const[k,sK]=useState(0);useEffect(()=>{const cv=ref.current;if(!cv)return;const ctx=cv.getContext("2d");return setup(cv,ctx,difficulty)},[difficulty,k]);return(<GW title={title} onBack={onBack} bg={bg}><div style={{display:"flex",flexDirection:"column",alignItems:"center",gap:8}}><canvas ref={ref} style={{borderRadius:14,maxWidth:"100%",touchAction:"none",boxShadow:"0 4px 30px rgba(0,0,0,0.5)"}}/><Btn onClick={()=>sK(k=>k+1)} color="#4d96ff">‚Üª Reset</Btn><p style={{color:"#556",fontSize:"0.78rem"}}>{hint}</p></div></GW>)}

// ==================== PONG ====================
function PongGame({onBack,difficulty}){return<CVG onBack={onBack} title="Pong" difficulty={difficulty} hint="Mouse/touch ¬∑ First to 11" setup={(cv,c,df)=>{const W=600,H=400;cv.width=W;cv.height=H;const MX=11;const as=df==="easy"?0.025:df==="medium"?0.045:0.07;const is=df==="easy"?3.5:df==="medium"?4.5:5.5;const s={pY:H/2-40,aY:H/2-40,bx:W/2,by:H/2,bvx:is,bvy:is*0.7,pS:0,aS:0,sh:0,run:true};const mv=e=>{const r=cv.getBoundingClientRect();s.pY=Math.max(0,Math.min(H-80,(e.clientY||e.touches?.[0]?.clientY||0)-r.top-40))};cv.addEventListener("mousemove",mv);cv.addEventListener("touchmove",e=>{e.preventDefault();mv(e)},{passive:false});const rb=d=>{s.bx=W/2;s.by=H/2;s.bvx=is*d;s.bvy=(Math.random()-0.5)*is};cv.addEventListener("click",()=>{if(s.pS>=MX||s.aS>=MX){s.pS=0;s.aS=0;rb(1)}});const lp=()=>{if(!s.run)return;if(s.pS<MX&&s.aS<MX){s.bx+=s.bvx;s.by+=s.bvy;if(s.by<=8||s.by>=H-8){s.bvy*=-1;Au.bounce()}s.aY+=(s.by-s.aY-40)*as;if(s.bx<=24&&s.by>s.pY-4&&s.by<s.pY+84){s.bvx=Math.abs(s.bvx)*1.04;s.bvy+=(s.by-s.pY-40)*0.12;Au.hit();s.sh=4}if(s.bx>=W-24&&s.by>s.aY-4&&s.by<s.aY+84){s.bvx=-Math.abs(s.bvx)*1.04;s.bvy+=(s.by-s.aY-40)*0.12;Au.hit();s.sh=4}if(s.bx<0){s.aS++;Au.lose();rb(1)}if(s.bx>W){s.pS++;Au.score();rb(-1)}if(Math.abs(s.bvx)>14)s.bvx=14*Math.sign(s.bvx)}if(s.sh>0)s.sh--;const sx=s.sh?(Math.random()-0.5)*s.sh:0;c.save();c.translate(sx,sx);c.fillStyle="#080820";c.fillRect(0,0,W,H);c.setLineDash([6,8]);c.strokeStyle="rgba(255,255,255,0.08)";c.beginPath();c.moveTo(W/2,0);c.lineTo(W/2,H);c.stroke();c.setLineDash([]);c.fillStyle="#ff6b6b";c.fillRect(8,s.pY,12,80);c.fillStyle="#4d96ff";c.fillRect(W-20,s.aY,12,80);c.fillStyle="#fff";c.beginPath();c.arc(s.bx,s.by,8,0,Math.PI*2);c.fill();c.fillStyle="rgba(255,255,255,0.6)";c.font="bold 42px 'Courier New'";c.textAlign="center";c.fillText(""+s.pS,W/2-50,55);c.fillText(""+s.aS,W/2+50,55);if(s.pS>=MX||s.aS>=MX){c.fillStyle="rgba(0,0,0,0.7)";c.fillRect(0,0,W,H);c.fillStyle=s.pS>=MX?"#6bcb77":"#ff6b6b";c.font="bold 36px sans-serif";c.fillText(s.pS>=MX?"You Win!":"AI Wins!",W/2,H/2);c.font="18px sans-serif";c.fillStyle="#aaa";c.fillText("Click to restart",W/2,H/2+35)}c.restore();requestAnimationFrame(lp)};requestAnimationFrame(lp);return()=>{s.run=false}}}/>;};

// ==================== PING PONG ====================
function PingPong({onBack,difficulty}){return<CVG onBack={onBack} title="Ping Pong" bg="#0a3018" difficulty={difficulty} hint="Mouse controls bottom ¬∑ First to 11" setup={(cv,c,df)=>{const W=600,H=400;cv.width=W;cv.height=H;const MX=11;const as=df==="easy"?0.025:df==="medium"?0.04:0.065;const s={px:W/2,ax:W/2,bx:W/2,by:H/2,bvx:3,bvy:-4,pS:0,aS:0,run:true};const mv=e=>{const r=cv.getBoundingClientRect();s.px=Math.max(45,Math.min(W-45,(e.clientX||e.touches?.[0]?.clientX||0)-r.left))};cv.addEventListener("mousemove",mv);cv.addEventListener("touchmove",e=>{e.preventDefault();mv(e)},{passive:false});cv.addEventListener("click",()=>{if(s.pS>=MX||s.aS>=MX){s.pS=0;s.aS=0;s.bx=W/2;s.by=H/2;s.bvx=3;s.bvy=-4}});const lp=()=>{if(!s.run)return;if(s.pS<MX&&s.aS<MX){s.bx+=s.bvx;s.by+=s.bvy;if(s.bx<=10||s.bx>=W-10){s.bvx*=-1;Au.bounce()}s.ax+=(s.bx-s.ax)*as;if(s.by<=22&&s.by>10&&Math.abs(s.bx-s.ax)<52){s.bvy=Math.abs(s.bvy);s.bvx+=(s.bx-s.ax)*0.08;Au.hit()}if(s.by>=H-22&&s.by<H-10&&Math.abs(s.bx-s.px)<52){s.bvy=-Math.abs(s.bvy);s.bvx+=(s.bx-s.px)*0.08;Au.hit()}if(s.by<0){s.pS++;Au.score();s.bx=W/2;s.by=H/2;s.bvx=3;s.bvy=4}if(s.by>H){s.aS++;Au.lose();s.bx=W/2;s.by=H/2;s.bvx=-3;s.bvy=-4}if(Math.abs(s.bvx)>10)s.bvx=10*Math.sign(s.bvx)}c.fillStyle="#0a3018";c.fillRect(0,0,W,H);c.strokeStyle="rgba(255,255,255,0.15)";c.lineWidth=2;c.strokeRect(20,10,W-40,H-20);c.fillStyle="rgba(255,255,255,0.12)";c.fillRect(20,H/2-1,W-40,3);c.fillStyle="#4d96ff";c.beginPath();c.ellipse(s.ax,16,48,10,0,0,Math.PI*2);c.fill();c.fillStyle="#ff6b6b";c.beginPath();c.ellipse(s.px,H-16,48,10,0,0,Math.PI*2);c.fill();c.fillStyle="#ffd93d";c.beginPath();c.arc(s.bx,s.by,8,0,Math.PI*2);c.fill();c.fillStyle="rgba(255,255,255,0.6)";c.font="bold 28px monospace";c.textAlign="center";c.fillText(""+s.aS,W/2,H/2-16);c.fillText(""+s.pS,W/2,H/2+30);if(s.pS>=MX||s.aS>=MX){c.fillStyle="rgba(0,0,0,0.7)";c.fillRect(0,0,W,H);c.fillStyle=s.pS>=MX?"#6bcb77":"#ff6b6b";c.font="bold 36px sans-serif";c.fillText(s.pS>=MX?"You Win!":"AI Wins!",W/2,H/2);c.font="18px sans-serif";c.fillStyle="#aaa";c.fillText("Click to restart",W/2,H/2+35)}requestAnimationFrame(lp)};requestAnimationFrame(lp);return()=>{s.run=false}}}/>;};

// ==================== FALL ====================
function FallGame({onBack,difficulty}){return<CVG onBack={onBack} title="Fall" bg="#0c0620" difficulty={difficulty} hint="‚Üê/‚Üí to steer through gaps ¬∑ Red line chases you!" setup={(cv,c,df)=>{const W=400,H=500;cv.width=W;cv.height=H;const ls=df==="easy"?0.5:df==="medium"?0.9:1.4;const gw=df==="easy"?90:df==="medium"?70:55;const s={bx:W/2,by:30,bvy:0,bvx:0,br:10,pl:[],sc:0,tl:0,go:false,cY:0,rl:-200,run:true};for(let i=0;i<300;i++){const gx=Math.random()*(W-gw);s.pl.push({gx,gw,y:80+i*65})}const kd=e=>{if(e.key==="ArrowLeft")s.tl=-1;if(e.key==="ArrowRight")s.tl=1};const ku=e=>{if(e.key==="ArrowLeft"&&s.tl===-1)s.tl=0;if(e.key==="ArrowRight"&&s.tl===1)s.tl=0};window.addEventListener("keydown",kd);window.addEventListener("keyup",ku);cv.addEventListener("touchstart",e=>{e.preventDefault();const r=cv.getBoundingClientRect();s.tl=e.touches[0].clientX-r.left<W/2?-1:1},{passive:false});cv.addEventListener("touchmove",e=>{e.preventDefault();const r=cv.getBoundingClientRect();s.tl=e.touches[0].clientX-r.left<W/2?-1:1},{passive:false});cv.addEventListener("touchend",()=>{s.tl=0});const lp=()=>{if(!s.run)return;if(!s.go){s.bvx+=s.tl*0.6;s.bvx*=0.94;s.bvy+=0.35;s.bx+=s.bvx;s.by+=s.bvy;if(s.bx<s.br){s.bx=s.br;s.bvx*=-0.4}if(s.bx>W-s.br){s.bx=W-s.br;s.bvx*=-0.4}for(const p of s.pl){if(s.bvy>0&&s.by+s.br>p.y&&s.by+s.br<p.y+14){const inGap=s.bx>p.gx+s.br&&s.bx<p.gx+p.gw-s.br;if(!inGap){s.by=p.y-s.br;s.bvy=-1.5;const ns=Math.floor((p.y-80)/65);if(ns>s.sc){s.sc=ns;Au.bounce()}}}}s.rl+=ls;if(s.by-s.rl>400)s.rl+=ls*0.5;if(s.by<s.rl){s.go=true;Au.lose()}s.cY=s.by-H/3}c.fillStyle="#0c0620";c.fillRect(0,0,W,H);for(let i=0;i<30;i++){const sx=(i*137.5)%W,sy=((i*97.3+s.cY*0.1)%H+H)%H;c.fillStyle="rgba(255,255,255,0.15)";c.fillRect(sx,sy,1.5,1.5)}const ry=s.rl-s.cY;c.fillStyle="rgba(255,0,0,0.08)";c.fillRect(0,0,W,Math.max(0,ry));if(ry>-10&&ry<H+10){c.fillStyle="#ff0000";c.fillRect(0,ry,W,3);c.fillStyle="rgba(255,50,50,0.5)";c.font="bold 12px monospace";c.textAlign="center";c.fillText("‚ñº DANGER ‚ñº",W/2,ry-6);c.textAlign="left"}for(const p of s.pl){const sy=p.y-s.cY;if(sy>-20&&sy<H+20){c.fillStyle="#3a7bff";if(p.gx>0){dRR(c,0,sy-5,p.gx,10,4);c.fill();c.strokeStyle="rgba(255,255,255,0.2)";c.lineWidth=1;c.stroke()}const rx=p.gx+p.gw;if(rx<W){dRR(c,rx,sy-5,W-rx,10,4);c.fill();c.strokeStyle="rgba(255,255,255,0.2)";c.lineWidth=1;c.stroke()}}}const by=s.by-s.cY;c.fillStyle="#ffd93d";c.beginPath();c.arc(s.bx,by,s.br,0,Math.PI*2);c.fill();c.fillStyle="#000";c.beginPath();c.arc(s.bx-3,by-2,2,0,Math.PI*2);c.fill();c.beginPath();c.arc(s.bx+3,by-2,2,0,Math.PI*2);c.fill();c.fillStyle="#fff";c.font="bold 20px monospace";c.fillText("Score: "+s.sc,12,30);if(s.go){c.fillStyle="rgba(0,0,0,0.8)";c.fillRect(0,0,W,H);c.fillStyle="#ff4444";c.font="bold 34px sans-serif";c.textAlign="center";c.fillText("Crushed!",W/2,H/2-15);c.fillStyle="#aaa";c.font="18px sans-serif";c.fillText("Score: "+s.sc,W/2,H/2+20);c.textAlign="left"}requestAnimationFrame(lp)};requestAnimationFrame(lp);return()=>{s.run=false;window.removeEventListener("keydown",kd);window.removeEventListener("keyup",ku)}}}/>;};

// ==================== DROP ====================
function DropGame({onBack,difficulty}){return<CVG onBack={onBack} title="Drop" bg="#1a0f05" difficulty={difficulty} hint="Move & click to drop ¬∑ Merge same fruits!" setup={(cv,c,df)=>{const FR=[{n:"ü´ê",r:12,c:"#4444cc"},{n:"üçí",r:16,c:"#cc2222"},{n:"üçá",r:20,c:"#8844aa"},{n:"üçä",r:26,c:"#ff8800"},{n:"üçé",r:30,c:"#ee3333"},{n:"üçê",r:35,c:"#88cc22"},{n:"üçë",r:40,c:"#ffaa66"},{n:"üçà",r:48,c:"#66cc66"},{n:"üçâ",r:55,c:"#22aa22"}];const md=df==="easy"?3:df==="medium"?3:2;const gv=df==="easy"?0.3:df==="medium"?0.4:0.5;const W=320,H=460;cv.width=W;cv.height=H;const s={f:[],dx:W/2,ni:Math.floor(Math.random()*md),sc:0,go:false,cd:0,run:true};const mv=e=>{const r=cv.getBoundingClientRect();s.dx=Math.max(30,Math.min(W-30,(e.clientX||e.touches?.[0]?.clientX||0)-r.left))};cv.addEventListener("mousemove",mv);cv.addEventListener("touchmove",e=>{e.preventDefault();mv(e)},{passive:false});const cl=()=>{if(s.go||s.cd>0)return;const idx=s.ni;const fr=FR[idx];s.f.push({x:s.dx,y:fr.r+10,vy:0,vx:0,idx,r:fr.r,st:false});s.ni=Math.floor(Math.random()*md);s.cd=15;Au.place()};cv.addEventListener("click",cl);cv.addEventListener("touchend",cl);const lp=()=>{if(!s.run)return;if(s.cd>0)s.cd--;for(const f of s.f){f.vy+=gv;f.y+=f.vy;f.x+=f.vx;f.vx*=0.97;if(f.y+f.r>H){f.y=H-f.r;f.vy*=-0.25;f.st=true}if(f.x-f.r<0){f.x=f.r;f.vx*=-0.5}if(f.x+f.r>W){f.x=W-f.r;f.vx*=-0.5}}for(let i=0;i<s.f.length;i++){for(let j=i+1;j<s.f.length;j++){const a=s.f[i],b=s.f[j];if(!a||!b)continue;const dx=b.x-a.x,dy=b.y-a.y,d=Math.sqrt(dx*dx+dy*dy);if(d<a.r+b.r){if(a.idx===b.idx&&a.idx<FR.length-1){const ni=a.idx+1;s.f.push({x:(a.x+b.x)/2,y:(a.y+b.y)/2,vy:-2,vx:0,idx:ni,r:FR[ni].r,st:false});s.f.splice(j,1);s.f.splice(i,1);s.sc+=(ni+1)*15;Au.merge();i=-1;break}else{const ol=(a.r+b.r-d)/2;const nx=dx/(d||1),ny=dy/(d||1);a.x-=nx*ol;a.y-=ny*ol;b.x+=nx*ol;b.y+=ny*ol;a.vx-=nx*0.4;a.vy-=ny*0.4;b.vx+=nx*0.4;b.vy+=ny*0.4}}}}if(s.f.some(f=>f.st&&f.y-f.r<35)&&!s.go){s.go=true;Au.lose()}c.fillStyle="#1a0f05";c.fillRect(0,0,W,H);c.fillStyle="rgba(255,60,60,0.12)";c.fillRect(0,0,W,35);c.strokeStyle="rgba(255,60,60,0.3)";c.setLineDash([4,4]);c.beginPath();c.moveTo(0,35);c.lineTo(W,35);c.stroke();c.setLineDash([]);for(const f of s.f){c.fillStyle=FR[f.idx].c;c.beginPath();c.arc(f.x,f.y,f.r,0,Math.PI*2);c.fill();c.font=Math.max(12,f.r*0.9)+"px sans-serif";c.textAlign="center";c.textBaseline="middle";c.fillText(FR[f.idx].n,f.x,f.y)}if(!s.go){const pf=FR[s.ni];c.globalAlpha=0.35;c.fillStyle=pf.c;c.beginPath();c.arc(s.dx,pf.r+10,pf.r,0,Math.PI*2);c.fill();c.font=pf.r*0.9+"px sans-serif";c.fillText(pf.n,s.dx,pf.r+10);c.globalAlpha=1}c.fillStyle="#fff";c.font="bold 16px monospace";c.textAlign="left";c.textBaseline="top";c.fillText(""+s.sc,8,8);if(s.go){c.fillStyle="rgba(0,0,0,0.8)";c.fillRect(0,0,W,H);c.fillStyle="#fff";c.font="bold 30px sans-serif";c.textAlign="center";c.textBaseline="middle";c.fillText("Game Over!",W/2,H/2-15);c.font="18px sans-serif";c.fillText("Score: "+s.sc,W/2,H/2+20)}requestAnimationFrame(lp)};requestAnimationFrame(lp);return()=>{s.run=false}}}/>;};

// ==================== JUMP ====================
function JumpGame({onBack,difficulty}){return<CVG onBack={onBack} title="Jump" bg="#0a1535" difficulty={difficulty} hint="‚Üê/‚Üí or tap sides" setup={(cv,c,df)=>{const W=360,H=520;cv.width=W;cv.height=H;const pg=df==="easy"?42:df==="medium"?52:65;const pw=df==="easy"?80:df==="medium"?65:50;const s={x:W/2,y:H-60,vx:0,vy:0,ps:[],sc:0,cY:0,go:false,hY:H-60,run:true};for(let i=0;i<150;i++)s.ps.push({x:Math.random()*(W-pw),y:H-30-i*pg,w:pw,t:i>20&&Math.random()<0.15?"m":"s",md:1});let md=0;const kd=e=>{if(e.key==="ArrowLeft")md=-1;if(e.key==="ArrowRight")md=1};const ku=()=>{md=0};window.addEventListener("keydown",kd);window.addEventListener("keyup",ku);cv.addEventListener("touchstart",e=>{e.preventDefault();const r=cv.getBoundingClientRect();md=e.touches[0].clientX-r.left<W/2?-1:1},{passive:false});cv.addEventListener("touchend",()=>{md=0});const lp=()=>{if(!s.run)return;if(!s.go){s.vx=md*5.5;s.vy+=0.38;s.x+=s.vx;s.y+=s.vy;if(s.x<-12)s.x=W+12;if(s.x>W+12)s.x=-12;for(const p of s.ps){if(p.t==="m"){p.x+=p.md*1.2;if(p.x<0||p.x>W-p.w)p.md*=-1}}if(s.vy>0){for(const p of s.ps){if(s.y+14>p.y&&s.y+14<p.y+12&&s.x>p.x-12&&s.x<p.x+p.w+12){s.vy=-10.5;s.y=p.y-14;Au.bounce()}}}if(s.y<s.hY){s.sc+=Math.floor(s.hY-s.y);s.hY=s.y}s.cY=Math.min(s.cY,s.y-H/3);if(s.y-s.cY>H+60){s.go=true;Au.lose()}}c.fillStyle="#0a1535";c.fillRect(0,0,W,H);for(let i=0;i<40;i++){const sx=(i*173.7)%W,sy=((i*91.3-s.cY*0.05)%H+H)%H;c.fillStyle="rgba(255,255,255,0.15)";c.fillRect(sx,sy,1.5,1.5)}for(const p of s.ps){const sy=p.y-s.cY;if(sy>-20&&sy<H+20){c.fillStyle=p.t==="m"?"#ff8800":"#6bcb77";dRR(c,p.x,sy,p.w,8,4);c.fill()}}const py=s.y-s.cY;c.fillStyle="#ffd93d";c.beginPath();c.arc(s.x,py,13,0,Math.PI*2);c.fill();c.fillStyle="#000";c.beginPath();c.arc(s.x-4,py-3,2.5,0,Math.PI*2);c.fill();c.beginPath();c.arc(s.x+4,py-3,2.5,0,Math.PI*2);c.fill();c.fillStyle="#fff";c.font="bold 20px monospace";c.fillText(""+s.sc,12,28);if(s.go){c.fillStyle="rgba(0,0,0,0.8)";c.fillRect(0,0,W,H);c.fillStyle="#fff";c.font="bold 32px sans-serif";c.textAlign="center";c.fillText("Fell!",W/2,H/2-15);c.fillStyle="#ffd93d";c.font="18px sans-serif";c.fillText("Score: "+s.sc,W/2,H/2+20);c.textAlign="left"}requestAnimationFrame(lp)};requestAnimationFrame(lp);return()=>{s.run=false;window.removeEventListener("keydown",kd);window.removeEventListener("keyup",ku)}}}/>;};

// ==================== PINBALL ====================
function PinballGame({onBack,difficulty}){return<CVG onBack={onBack} title="Pinball" bg="#0a0520" difficulty={difficulty} hint="‚Üê/‚Üí or tap sides ¬∑ 3 lives" setup={(cv,c,df)=>{const W=320,H=520;cv.width=W;cv.height=H;const bb=df==="easy"?7:df==="medium"?6:5;const gv=df==="easy"?0.12:df==="medium"?0.16:0.2;const s={bx:W/2,by:60,bvx:2+Math.random()*2,bvy:3,br:8,sc:0,lf:false,rf:false,bumps:[{x:80,y:140,r:22,h:0},{x:240,y:140,r:22,h:0},{x:160,y:95,r:26,h:0},{x:100,y:250,r:18,h:0},{x:220,y:250,r:18,h:0},{x:160,y:200,r:16,h:0},{x:60,y:340,r:14,h:0},{x:260,y:340,r:14,h:0}],go:false,lv:3,run:true};const kd=e=>{if(e.key==="ArrowLeft"||e.key==="z")s.lf=true;if(e.key==="ArrowRight"||e.key==="/")s.rf=true};const ku=e=>{if(e.key==="ArrowLeft"||e.key==="z")s.lf=false;if(e.key==="ArrowRight"||e.key==="/")s.rf=false};window.addEventListener("keydown",kd);window.addEventListener("keyup",ku);cv.addEventListener("touchstart",e=>{e.preventDefault();const r=cv.getBoundingClientRect();for(const t of e.changedTouches){if(t.clientX-r.left<W/2)s.lf=true;else s.rf=true}},{passive:false});cv.addEventListener("touchend",()=>{s.lf=false;s.rf=false});const lp=()=>{if(!s.run)return;if(!s.go){s.bvy+=gv;s.bx+=s.bvx;s.by+=s.bvy;if(s.bx<s.br+12){s.bx=s.br+12;s.bvx=Math.abs(s.bvx)*0.7}if(s.bx>W-s.br-12){s.bx=W-s.br-12;s.bvx=-Math.abs(s.bvx)*0.7}if(s.by<s.br){s.by=s.br;s.bvy=Math.abs(s.bvy)*0.7}for(const b of s.bumps){const dx=s.bx-b.x,dy=s.by-b.y,d=Math.sqrt(dx*dx+dy*dy);if(d<s.br+b.r&&d>0){s.bvx=dx/d*bb;s.bvy=dy/d*bb;s.sc+=100;b.h=8;Au.bounce()}}for(const b of s.bumps)if(b.h>0)b.h--;const fy=H-55;if(s.lf&&s.by>fy-14&&s.by<fy+14&&s.bx>40&&s.bx<W/2-5){s.bvy=-9;s.bvx+=3;s.sc+=10;Au.flip()}if(s.rf&&s.by>fy-14&&s.by<fy+14&&s.bx>W/2+5&&s.bx<W-40){s.bvy=-9;s.bvx-=3;s.sc+=10;Au.flip()}if(s.by>H+20){s.lv--;if(s.lv<=0){s.go=true;Au.lose()}else{s.bx=W/2;s.by=60;s.bvx=2+Math.random()*2;s.bvy=3;Au.hit()}}}c.fillStyle="#0a0520";c.fillRect(0,0,W,H);c.fillStyle="#1a1040";c.fillRect(0,0,12,H);c.fillRect(W-12,0,12,H);for(const b of s.bumps){c.fillStyle=b.h>0?"#ff6b6b":"#2a1a60";c.beginPath();c.arc(b.x,b.y,b.r,0,Math.PI*2);c.fill();c.strokeStyle="rgba(255,255,255,0.3)";c.lineWidth=2;c.stroke();c.fillStyle="#fff";c.font="bold 10px monospace";c.textAlign="center";c.textBaseline="middle";c.fillText("100",b.x,b.y)}const fy=H-55;c.strokeStyle=s.lf?"#ffd93d":"#666";c.lineWidth=10;c.lineCap="round";c.beginPath();c.moveTo(55,fy+(s.lf?-8:0));c.lineTo(W/2-15,fy);c.stroke();c.strokeStyle=s.rf?"#ffd93d":"#666";c.beginPath();c.moveTo(W-55,fy+(s.rf?-8:0));c.lineTo(W/2+15,fy);c.stroke();c.fillStyle="#eee";c.beginPath();c.arc(s.bx,s.by,s.br,0,Math.PI*2);c.fill();c.fillStyle="#fff";c.font="bold 18px monospace";c.textAlign="left";c.textBaseline="top";c.fillText(""+s.sc,18,12);c.textAlign="right";c.fillText("‚óè".repeat(Math.max(0,s.lv)),W-18,12);c.textAlign="left";if(s.go){c.fillStyle="rgba(0,0,0,0.8)";c.fillRect(0,0,W,H);c.fillStyle="#fff";c.font="bold 28px sans-serif";c.textAlign="center";c.textBaseline="middle";c.fillText("Game Over!",W/2,H/2-15);c.fillStyle="#ffd93d";c.font="22px sans-serif";c.fillText("Score: "+s.sc,W/2,H/2+20);c.textAlign="left"}requestAnimationFrame(lp)};requestAnimationFrame(lp);return()=>{s.run=false;window.removeEventListener("keydown",kd);window.removeEventListener("keyup",ku)}}}/>;};

// ==================== TETRIS ====================
function Tetris({onBack,difficulty}){const W=10,H=20;const SH=[{s:[[1,1,1,1]],c:"#00e5ff"},{s:[[1,1],[1,1]],c:"#ffeb3b"},{s:[[0,1,0],[1,1,1]],c:"#aa00ff"},{s:[[1,0,0],[1,1,1]],c:"#2962ff"},{s:[[0,0,1],[1,1,1]],c:"#ff6d00"},{s:[[0,1,1],[1,1,0]],c:"#00e676"},{s:[[1,1,0],[0,1,1]],c:"#ff1744"}];const spd=difficulty==="easy"?600:difficulty==="medium"?420:260;const[gr,sGr]=useState(()=>Array(H).fill(null).map(()=>Array(W).fill(null)));const[pc,sPc]=useState(null);const[pos,sPos]=useState({x:3,y:0});const[sc,sSc]=useState(0);const[ln,sLn]=useState(0);const[go,sGo]=useState(false);const gR=useRef(gr);const pR=useRef(pc);const psR=useRef(pos);const goR=useRef(false);gR.current=gr;pR.current=pc;psR.current=pos;goR.current=go;const nP=useCallback(()=>{const p=SH[Math.floor(Math.random()*SH.length)];return{...p,s:p.s.map(r=>[...r])}},[]);const col=useCallback((g,p,px,py)=>{for(let r=0;r<p.s.length;r++)for(let c=0;c<p.s[r].length;c++){if(p.s[r][c]){const nr=py+r,nc=px+c;if(nr<0||nr>=H||nc<0||nc>=W||g[nr]?.[nc])return true}}return false},[]);const plc=useCallback((g,p,px,py)=>{const ng=g.map(r=>[...r]);for(let r=0;r<p.s.length;r++)for(let c=0;c<p.s[r].length;c++){if(p.s[r][c]&&py+r>=0&&py+r<H&&px+c>=0&&px+c<W)ng[py+r][px+c]=p.c}return ng},[]);const clr=useCallback(g=>{let cl=0;const ng=g.filter(r=>{if(r.every(c=>c)){cl++;return false}return true});while(ng.length<H)ng.unshift(Array(W).fill(null));return{g:ng,c:cl}},[]);const rot=useCallback(sh=>{const r=sh.length,c=sh[0].length;return Array(c).fill(null).map((_,ci)=>Array(r).fill(null).map((_,ri)=>sh[r-1-ri][ci]))},[]);useEffect(()=>{if(!pc){const p=nP();if(col(gr,p,3,0)){sGo(true);Au.lose();return}sPc(p);sPos({x:3,y:0})}},[pc,gr,nP,col]);useEffect(()=>{if(go||!pc)return;const tk=()=>{const g=gR.current,p=pR.current,ps=psR.current;if(!p||goR.current)return;if(!col(g,p,ps.x,ps.y+1))sPos(pr=>({...pr,y:pr.y+1}));else{Au.place();const ng=plc(g,p,ps.x,ps.y);const{g:cg,c:cl}=clr(ng);if(cl)Au.score();sGr(cg);sSc(s=>s+cl*100+(cl>=4?200:0)+10);sLn(l=>l+cl);sPc(null)}};const id=setInterval(tk,spd);return()=>clearInterval(id)},[pc,go,col,plc,clr,spd]);useEffect(()=>{const k=e=>{const g=gR.current,p=pR.current,ps=psR.current;if(!p||goR.current)return;if(e.key==="ArrowLeft"&&!col(g,p,ps.x-1,ps.y))sPos(pr=>({...pr,x:pr.x-1}));if(e.key==="ArrowRight"&&!col(g,p,ps.x+1,ps.y))sPos(pr=>({...pr,x:pr.x+1}));if(e.key==="ArrowDown"&&!col(g,p,ps.x,ps.y+1))sPos(pr=>({...pr,y:pr.y+1}));if(e.key==="ArrowUp"){const rt={...p,s:rot(p.s)};if(!col(g,rt,ps.x,ps.y))sPc(rt)}if(e.key===" "){e.preventDefault();let ny=ps.y;while(!col(g,p,ps.x,ny+1))ny++;sPos({...ps,y:ny})}};window.addEventListener("keydown",k);return()=>window.removeEventListener("keydown",k)},[col,rot]);const rs=()=>{sGr(Array(H).fill(null).map(()=>Array(W).fill(null)));sPc(null);sSc(0);sLn(0);sGo(false)};const dp=gr.map(r=>[...r]);if(pc){for(let r=0;r<pc.s.length;r++)for(let c=0;c<pc.s[r].length;c++){if(pc.s[r][c]&&pos.y+r>=0&&pos.y+r<H&&pos.x+c>=0&&pos.x+c<W)dp[pos.y+r][pos.x+c]=pc.c}}if(pc){let gy=pos.y;while(!col(gr,pc,pos.x,gy+1))gy++;if(gy!==pos.y){for(let r=0;r<pc.s.length;r++)for(let c=0;c<pc.s[r].length;c++){if(pc.s[r][c]&&gy+r>=0&&gy+r<H&&pos.x+c>=0&&pos.x+c<W&&!dp[gy+r][pos.x+c])dp[gy+r][pos.x+c]=pc.c+"30"}}}return(<GW title="Tetris" onBack={onBack} score={sc+" ¬∑ "+ln+" lines"}><div style={{display:"flex",flexDirection:"column",alignItems:"center",gap:10,position:"relative"}}><div style={{display:"grid",gridTemplateColumns:`repeat(${W},26px)`,gap:1,background:"rgba(255,255,255,0.03)",padding:3,borderRadius:10,border:"1px solid rgba(255,255,255,0.08)"}}>{dp.flat().map((v,i)=><div key={i} style={{width:26,height:26,background:v||"rgba(255,255,255,0.015)",borderRadius:3,border:v&&!String(v).endsWith("30")?"1px solid rgba(255,255,255,0.15)":"none"}}/>)}</div><div style={{display:"flex",gap:6}}><CB onClick={()=>{const g=gR.current,p=pR.current,ps=psR.current;if(p&&!col(g,p,ps.x-1,ps.y))sPos(pr=>({...pr,x:pr.x-1}))}}>‚Üê</CB><CB onClick={()=>{const p=pR.current,g=gR.current,ps=psR.current;if(p){const rt={...p,s:rot(p.s)};if(!col(g,rt,ps.x,ps.y))sPc(rt)}}}>‚Üª</CB><CB onClick={()=>{const g=gR.current,p=pR.current,ps=psR.current;if(p&&!col(g,p,ps.x,ps.y+1))sPos(pr=>({...pr,y:pr.y+1}))}}>‚Üì</CB><CB onClick={()=>{const g=gR.current,p=pR.current,ps=psR.current;if(p&&!col(g,p,ps.x+1,ps.y))sPos(pr=>({...pr,x:pr.x+1}))}}>‚Üí</CB><CB onClick={()=>{const g=gR.current,p=pR.current,ps=psR.current;if(p){let ny=ps.y;while(!col(g,p,ps.x,ny+1))ny++;sPos({x:ps.x,y:ny})}}}>‚è¨</CB></div>{go&&<GO score={sc} onReset={rs} message={ln+" lines"}/>}<p style={{color:"#445",fontSize:"0.75rem"}}>Arrow keys ¬∑ Space = hard drop</p></div></GW>)}

// ==================== SNAKE ====================
function SnakeGame({onBack,difficulty}){const S=20,CS=20;const spd=difficulty==="easy"?180:difficulty==="medium"?130:90;const bc=difficulty==="easy"?3:difficulty==="medium"?5:8;const[sn,sSn]=useState([{x:10,y:10}]);const[dir,sDir]=useState({x:1,y:0});const[bots,sBots]=useState([]);const[sc,sSc]=useState(0);const[go,sGo]=useState(false);const dR=useRef({x:1,y:0});useEffect(()=>{dR.current=dir},[dir]);useEffect(()=>{const b=[];const cl=["#ff6b6b","#ffd93d","#6bcb77","#4d96ff","#a855f7","#ff8800","#e85d75","#00bcd4"];for(let i=0;i<bc;i++){const sx=Math.floor(Math.random()*(S-6))+3;const sy=Math.floor(Math.random()*(S-6))+3;const sg=[];for(let j=0;j<Math.floor(Math.random()*3)+2;j++)sg.push({x:(sx-j+S)%S,y:sy});b.push({segs:sg,dir:{x:1,y:0},color:cl[i%cl.length]})}sBots(b)},[bc]);useEffect(()=>{if(go)return;const k=e=>{const d=dR.current;if(e.key==="ArrowUp"&&d.y!==1)sDir({x:0,y:-1});if(e.key==="ArrowDown"&&d.y!==-1)sDir({x:0,y:1});if(e.key==="ArrowLeft"&&d.x!==1)sDir({x:-1,y:0});if(e.key==="ArrowRight"&&d.x!==-1)sDir({x:1,y:0})};window.addEventListener("keydown",k);return()=>window.removeEventListener("keydown",k)},[go]);useEffect(()=>{if(go)return;const id=setInterval(()=>{sSn(prev=>{const d=dR.current;const h={x:(prev[0].x+d.x+S)%S,y:(prev[0].y+d.y+S)%S};const ns=[h,...prev];sBots(pb=>{const nb=pb.map(b=>{const r={...b,segs:[...b.segs],dir:{...b.dir}};if(Math.random()<0.15){const ds=[{x:1,y:0},{x:-1,y:0},{x:0,y:1},{x:0,y:-1}];r.dir=ds[Math.floor(Math.random()*4)]}const nh={x:(r.segs[0].x+r.dir.x+S)%S,y:(r.segs[0].y+r.dir.y+S)%S};r.segs=[nh,...r.segs.slice(0,-1)];return r});for(let i=nb.length-1;i>=0;i--){if(nb[i].segs.length<ns.length-1){if(nb[i].segs.some(s=>s.x===h.x&&s.y===h.y)){const ea=nb[i].segs.length;nb.splice(i,1);Au.score();sSc(s=>s+ea*50);for(let j=0;j<ea;j++)ns.push({...ns[ns.length-1]})}}else{if(nb[i].segs[0].x===h.x&&nb[i].segs[0].y===h.y){Au.lose();sGo(true)}}}return nb});ns.pop();return ns})},spd);return()=>clearInterval(id)},[go,spd]);const rs=()=>{sSn([{x:10,y:10}]);sDir({x:1,y:0});dR.current={x:1,y:0};sSc(0);sGo(false);sBots([])};const cells=new Map();sn.forEach((s,i)=>cells.set(s.x+","+s.y,{color:i===0?"#00ff88":"#00cc66",head:i===0}));bots.forEach(b=>b.segs.forEach((s,i)=>cells.set(s.x+","+s.y,{color:i===0?"#fff":b.color,head:i===0})));return(<GW title="Snake" onBack={onBack} score={sc}><div style={{display:"flex",flexDirection:"column",alignItems:"center",gap:10,position:"relative"}}><div style={{fontSize:"0.8rem",color:"#667"}}>You: {sn.length} segs ¬∑ Eat smaller, avoid bigger!</div><div style={{display:"grid",gridTemplateColumns:`repeat(${S},${CS}px)`,gap:1,background:"rgba(255,255,255,0.02)",borderRadius:10,padding:3,border:"1px solid rgba(255,255,255,0.06)"}}>{Array(S*S).fill(0).map((_,i)=>{const x=i%S,y=Math.floor(i/S);const c=cells.get(x+","+y);return<div key={i} style={{width:CS,height:CS,background:c?c.color:"rgba(255,255,255,0.01)",borderRadius:c?.head?4:2}}/>})}</div><div style={{display:"flex",flexDirection:"column",alignItems:"center",gap:4}}><CB onClick={()=>{if(dR.current.y!==1)sDir({x:0,y:-1})}}>‚Üë</CB><div style={{display:"flex",gap:4}}><CB onClick={()=>{if(dR.current.x!==1)sDir({x:-1,y:0})}}>‚Üê</CB><CB onClick={()=>{if(dR.current.y!==-1)sDir({x:0,y:1})}}>‚Üì</CB><CB onClick={()=>{if(dR.current.x!==-1)sDir({x:1,y:0})}}>‚Üí</CB></div></div>{go&&<GO score={sc} onReset={rs} message="Eaten by bigger snake!"/>}</div></GW>)}

// ==================== BASEBALL ====================
function Baseball({onBack,difficulty}){const[ph,sPh]=useState("ready");const[by,sBY]=useState(0);const[sc,sSc]=useState(0);const[an,sAn]=useState("üêª");const[rs2,sRs]=useState("");const[sk,sSk]=useState(0);const[sw,sSw]=useState(0);const as=["üêª","ü¶ä","üê∞","üê∏","üê±","ü¶Å","üêº","üê®","ü¶Ñ","üêØ"];const iR=useRef(null);const phR=useRef("ready");useEffect(()=>{phR.current=ph},[ph]);const ps=difficulty==="easy"?1.8:difficulty==="medium"?2.8:4.2;const ss=difficulty==="easy"?18:difficulty==="medium"?10:5;const pitch=()=>{sPh("pitching");sBY(0);sRs("");sAn(as[Math.floor(Math.random()*as.length)]);let y=0;iR.current=setInterval(()=>{y+=ps;sBY(y);if(y>=130){clearInterval(iR.current);sPh("result");sRs("Strike! ‚ùå");sSk(0);Au.lose()}},16)};const swing=()=>{if(phR.current!=="pitching")return;clearInterval(iR.current);Au.swing();const d=Math.abs(by-90);sSw(s=>s+1);let r;if(d<ss){r="‚ö° HOME RUN! ‚ö°";sSc(s=>s+100+sk*25);sSk(s=>s+1);Au.win()}else if(d<ss*2.5){r="Triple! üî•";sSc(s=>s+50);sSk(s=>s+1);Au.score()}else if(d<ss*4){r="Single! ‚öæ";sSc(s=>s+20);sSk(s=>s+1);Au.hit()}else{r="Whiff! üí®";sSk(0);Au.lose()}sRs(r);sPh("result")};useEffect(()=>()=>{if(iR.current)clearInterval(iR.current)},[]);return(<GW title="Baseball" onBack={onBack} bg="#1a2a0a" score={sc}><div style={{display:"flex",flexDirection:"column",alignItems:"center",gap:14,paddingTop:16}}>{sk>1&&<div style={{background:"rgba(255,107,107,0.15)",padding:"6px 20px",borderRadius:20,color:"#ff6b6b",fontWeight:800}}>üî• {sk} streak!</div>}<div style={{width:300,height:240,background:"linear-gradient(180deg,#87CEEB 0%,#65B86A 65%,#4a8a3f 100%)",borderRadius:20,position:"relative",overflow:"hidden",border:"3px solid rgba(255,255,255,0.15)"}}><div style={{position:"absolute",top:85,left:"25%",right:"25%",height:3,background:"rgba(255,255,0,0.25)",borderRadius:2}}/><div style={{position:"absolute",bottom:16,left:"50%",transform:"translateX(-50%)",fontSize:"3.2rem"}}>{an}</div><div style={{position:"absolute",bottom:45,left:"62%",width:5,height:45,background:"linear-gradient(#8B4513,#654321)",transform:`rotate(${ph==="pitching"?"-35deg":"10deg"})`,borderRadius:3,transition:"transform 0.08s",transformOrigin:"bottom center"}}/>{ph==="pitching"&&<div style={{position:"absolute",top:by,left:"50%",transform:"translateX(-50%)",width:18,height:18,background:"radial-gradient(#fff 40%,#ddd)",borderRadius:"50%",boxShadow:"0 2px 8px rgba(0,0,0,0.3)"}}/>}</div>{rs2&&<p style={{fontSize:"1.3rem",fontWeight:800,color:rs2.includes("HOME")?"#ffd93d":rs2.includes("Strike")||rs2.includes("Whiff")?"#ff6b6b":"#6bcb77"}}>{rs2}</p>}<div style={{display:"flex",gap:12}}>{ph!=="pitching"&&<Btn onClick={pitch} color="#4d96ff" size="lg">‚öæ Pitch!</Btn>}{ph==="pitching"&&<button onClick={swing} style={{padding:"18px 48px",borderRadius:16,border:"none",background:"linear-gradient(135deg,#ff6b6b,#ff3355)",color:"#fff",fontWeight:900,cursor:"pointer",fontSize:"1.3rem",animation:"pulse 0.4s infinite"}}>üèè SWING!</button>}</div><p style={{color:"#556",fontSize:"0.78rem"}}>{sw} swings ¬∑ Hit at yellow line!</p></div></GW>)}

// ==================== CHESS ====================
function Chess({onBack,difficulty}){const ib=()=>{const b=Array(8).fill(null).map(()=>Array(8).fill(null));const bp=["‚ôú","‚ôû","‚ôù","‚ôõ","‚ôö","‚ôù","‚ôû","‚ôú"];const wp=["‚ôñ","‚ôò","‚ôó","‚ôï","‚ôî","‚ôó","‚ôò","‚ôñ"];for(let i=0;i<8;i++){b[0][i]={p:bp[i],c:"b"};b[1][i]={p:"‚ôü",c:"b"};b[6][i]={p:"‚ôô",c:"w"};b[7][i]={p:wp[i],c:"w"}}return b};const[bd,sBd]=useState(ib);const[sel,sSel]=useState(null);const[tn,sTn]=useState("w");const[st,sSt]=useState("White's turn");const[cp,sCp]=useState([]);const iv=(b,fr,fc,tr,tc,cl)=>{const pc=b[fr]?.[fc];if(!pc||pc.c!==cl)return false;const tg=b[tr]?.[tc];if(tg&&tg.c===cl)return false;const dr=tr-fr,dc=tc-fc,adr=Math.abs(dr),adc=Math.abs(dc);const p=pc.p;if(p==="‚ôô"||p==="‚ôü"){const d=pc.c==="w"?-1:1;const s=pc.c==="w"?6:1;if(dc===0&&!tg){if(dr===d)return true;if(fr===s&&dr===2*d&&!b[fr+d]?.[fc])return true}if(adc===1&&dr===d&&tg)return true;return false}if(p==="‚ôú"||p==="‚ôñ"){if(dr!==0&&dc!==0)return false;const sr=Math.sign(dr),sc=Math.sign(dc);for(let i=1;i<Math.max(adr,adc);i++){if(b[fr+sr*i]?.[fc+sc*i])return false}return true}if(p==="‚ôû"||p==="‚ôò")return(adr===2&&adc===1)||(adr===1&&adc===2);if(p==="‚ôù"||p==="‚ôó"){if(adr!==adc)return false;const sr=Math.sign(dr),sc=Math.sign(dc);for(let i=1;i<adr;i++){if(b[fr+sr*i]?.[fc+sc*i])return false}return true}if(p==="‚ôõ"||p==="‚ôï"){if(dr===0||dc===0||adr===adc){const sr=Math.sign(dr),sc=Math.sign(dc);for(let i=1;i<Math.max(adr,adc);i++){if(b[fr+sr*i]?.[fc+sc*i])return false}return true}return false}if(p==="‚ôö"||p==="‚ôî")return adr<=1&&adc<=1;return false};const ai=b=>{const ms=[];for(let r=0;r<8;r++)for(let c2=0;c2<8;c2++){if(b[r]?.[c2]?.c==="b"){for(let tr=0;tr<8;tr++)for(let tc=0;tc<8;tc++){if(iv(b,r,c2,tr,tc,"b"))ms.push({fr:r,fc:c2,tr,tc})}}}if(!ms.length)return null;const pv={"‚ôü":1,"‚ôú":5,"‚ôû":3,"‚ôù":3,"‚ôõ":9,"‚ôö":100,"‚ôô":1,"‚ôñ":5,"‚ôò":3,"‚ôó":3,"‚ôï":9,"‚ôî":100};const sc2=ms.map(m=>{let s=0;const t=b[m.tr]?.[m.tc];if(t)s+=pv[t.p]||1;s+=(difficulty==="easy"?Math.random()*5:difficulty==="medium"?Math.random()*2:Math.random()*0.5);return{...m,s}});sc2.sort((a,b)=>b.s-a.s);return sc2[0]};const doAi=useCallback(cb=>{setTimeout(()=>{const mv=ai(cb);if(mv){const nb=cb.map(r=>r.map(c=>c?{...c}:null));const cap=nb[mv.tr][mv.tc];if(cap)sCp(p=>[...p,cap.p]);nb[mv.tr][mv.tc]=nb[mv.fr][mv.fc];nb[mv.fr][mv.fc]=null;if(nb[mv.tr][mv.tc]?.p==="‚ôü"&&mv.tr===7)nb[mv.tr][mv.tc]={p:"‚ôõ",c:"b"};if(cap&&cap.p==="‚ôî"){sBd(nb);sSt("Black wins!");Au.lose();sTn("x");return}sBd(nb);Au.place()}sTn("w");sSt("White's turn")},300)},[difficulty]);const cl=(r,c)=>{if(tn!=="w")return;if(sel){if(iv(bd,sel.r,sel.c,r,c,"w")){Au.place();const nb=bd.map(rw=>rw.map(c2=>c2?{...c2}:null));const cap=nb[r][c];if(cap)sCp(p=>[...p,cap.p]);nb[r][c]=nb[sel.r][sel.c];nb[sel.r][sel.c]=null;if(nb[r][c]?.p==="‚ôô"&&r===0)nb[r][c]={p:"‚ôï",c:"w"};if(cap&&cap.p==="‚ôö"){sBd(nb);sSt("White wins! üéâ");Au.win();sSel(null);sTn("x");return}sBd(nb);sSel(null);sTn("b");sSt("Thinking...");doAi(nb)}else sSel(bd[r]?.[c]?.c===tn?{r,c}:null)}else{if(bd[r]?.[c]?.c===tn){sSel({r,c});Au.click()}}};return(<GW title="Chess" onBack={onBack}><div style={{display:"flex",flexDirection:"column",alignItems:"center",gap:10}}><p style={{fontWeight:700,color:st.includes("wins")?(st.includes("White")?"#6bcb77":"#ff6b6b"):"#ccc"}}>{st}</p>{cp.length>0&&<div style={{display:"flex",gap:2,flexWrap:"wrap",maxWidth:340}}>{cp.map((c,i)=><span key={i} style={{fontSize:"1.1rem",opacity:0.6}}>{c}</span>)}</div>}<div style={{display:"grid",gridTemplateColumns:"repeat(8,44px)",gap:0,borderRadius:10,overflow:"hidden",border:"2px solid rgba(255,255,255,0.15)"}}>{bd.flat().map((cell,i)=>{const r=Math.floor(i/8),c=i%8;const lt=(r+c)%2===0;const sl=sel?.r===r&&sel?.c===c;const cm=sel&&iv(bd,sel.r,sel.c,r,c,"w");return<div key={i} onClick={()=>cl(r,c)} style={{width:44,height:44,display:"flex",alignItems:"center",justifyContent:"center",background:sl?"#ffd93d":cm?"rgba(107,203,119,0.35)":lt?"#f0d9b5":"#b58863",cursor:"pointer",fontSize:"1.9rem"}}>{cm&&!cell&&<div style={{width:12,height:12,borderRadius:"50%",background:"rgba(107,203,119,0.5)"}}/>}{cell?.p}</div>})}</div><Btn onClick={()=>{sBd(ib());sTn("w");sSel(null);sSt("White's turn");sCp([])}} color="#4d96ff">New Game</Btn></div></GW>)}

// ==================== CHECKERS ====================
function Checkers({onBack,difficulty}){const ini=()=>{const b=Array(8).fill(null).map(()=>Array(8).fill(null));for(let r=0;r<3;r++)for(let c=0;c<8;c++){if((r+c)%2===1)b[r][c]={c:"b",k:false}}for(let r=5;r<8;r++)for(let c=0;c<8;c++){if((r+c)%2===1)b[r][c]={c:"r",k:false}}return b};const[bd,sBd]=useState(ini);const[sel,sSel]=useState(null);const[tn,sTn]=useState("r");const[st,sSt]=useState("Red's turn");const tm=(b,fr,fc,tr,tc)=>{const p=b[fr]?.[fc];if(!p||tr<0||tr>7||tc<0||tc>7||b[tr]?.[tc])return null;const dr=tr-fr,dc=tc-fc,adr=Math.abs(dr),adc=Math.abs(dc);const vd=p.k||(p.c==="r"?dr<0:dr>0);if(!vd)return null;if(adr===1&&adc===1){const nb=b.map(r=>r.map(c=>c?{...c}:null));nb[tr][tc]=nb[fr][fc];nb[fr][fc]=null;if((tr===0&&p.c==="r")||(tr===7&&p.c==="b"))nb[tr][tc].k=true;return{board:nb,cap:false}}if(adr===2&&adc===2){const mr=fr+dr/2,mc=fc+dc/2;if(b[mr]?.[mc]&&b[mr][mc].c!==p.c){const nb=b.map(r=>r.map(c=>c?{...c}:null));nb[tr][tc]=nb[fr][fc];nb[fr][fc]=null;nb[mr][mc]=null;if((tr===0&&p.c==="r")||(tr===7&&p.c==="b"))nb[tr][tc].k=true;return{board:nb,cap:true}}}return null};const cl=(r,c)=>{if(tn!=="r")return;if(sel){const res=tm(bd,sel.r,sel.c,r,c);if(res){Au.place();sBd(res.board);sSel(null);sTn("b");sSt("Thinking...");setTimeout(()=>{const ms=[];for(let r2=0;r2<8;r2++)for(let c2=0;c2<8;c2++){if(res.board[r2]?.[c2]?.c==="b"){for(let tr=0;tr<8;tr++)for(let tc=0;tc<8;tc++){const r3=tm(res.board,r2,c2,tr,tc);if(r3)ms.push(r3)}}}if(ms.length){const caps=ms.filter(m=>m.cap);const pool=caps.length?caps:ms;Au.place();sBd((difficulty==="hard"?pool[0]:pool[Math.floor(Math.random()*pool.length)]).board)}sTn("r");sSt("Red's turn")},400)}else if(bd[r]?.[c]?.c===tn){sSel({r,c});Au.click()}else sSel(null)}else{if(bd[r]?.[c]?.c===tn){sSel({r,c});Au.click()}}};return(<GW title="Checkers" onBack={onBack}><div style={{display:"flex",flexDirection:"column",alignItems:"center",gap:10}}><p style={{fontWeight:700}}>{st}</p><div style={{display:"grid",gridTemplateColumns:"repeat(8,44px)",gap:0,borderRadius:10,overflow:"hidden",border:"2px solid rgba(255,255,255,0.15)"}}>{Array(64).fill(0).map((_,i)=>{const r=Math.floor(i/8),c=i%8;const dk=(r+c)%2===1;const p=bd[r][c];const sl=sel?.r===r&&sel?.c===c;return<div key={i} onClick={()=>cl(r,c)} style={{width:44,height:44,background:sl?"#ffd93d":dk?"#556b2f":"#f5f5dc",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer"}}>{p&&<div style={{width:32,height:32,borderRadius:"50%",background:p.c==="r"?"radial-gradient(circle at 35% 35%,#ff4444,#aa0000)":"radial-gradient(circle at 35% 35%,#555,#222)",border:p.k?"3px solid gold":"2px solid rgba(255,255,255,0.3)",display:"flex",alignItems:"center",justifyContent:"center",color:"#fff",fontWeight:900,fontSize:"0.75rem"}}>{p.k?"‚ôî":""}</div>}</div>})}</div><Btn onClick={()=>{sBd(ini());sTn("r");sSel(null);sSt("Red's turn")}} color="#4d96ff">New Game</Btn></div></GW>)}

// ==================== MANCALA ====================
function Mancala({onBack,difficulty}){const ini=()=>({p:[4,4,4,4,4,4,0,4,4,4,4,4,4,0],t:0});const[s,sS]=useState(ini);const[msg,sMsg]=useState("Your turn");const play=idx=>{const{p:pts,t}=s;if(t!==0||idx<0||idx>5||pts[idx]===0)return;Au.place();const np=[...pts];let st=np[idx];np[idx]=0;let pos=idx;while(st>0){pos=(pos+1)%14;if(pos===13)continue;np[pos]++;st--}if(pos!==6&&pos>=0&&pos<=5&&np[pos]===1){const opp=12-pos;if(np[opp]>0){np[6]+=np[opp]+1;np[pos]=0;np[opp]=0;Au.score()}}const s1=np.slice(0,6).reduce((a,b)=>a+b,0),s2=np.slice(7,13).reduce((a,b)=>a+b,0);if(s1===0||s2===0){np[6]+=s1;np[13]+=s2;for(let i=0;i<6;i++){np[i]=0;np[i+7]=0}sMsg(np[6]>np[13]?"You win! üéâ":np[13]>np[6]?"AI wins!":"Draw!");Au[np[6]>np[13]?"win":"lose"]();sS({p:np,t:-1});return}if(pos===6){sS({p:np,t:0});sMsg("Extra turn!");return}sS({p:np,t:1});sMsg("AI thinking...");setTimeout(()=>{const av=[];for(let i=7;i<=12;i++)if(np[i]>0)av.push(i);if(!av.length)return;let pk;if(difficulty==="easy")pk=av[Math.floor(Math.random()*av.length)];else{const sm=av.filter(i=>{let p2=i,s3=np[i];while(s3>0){p2=(p2+1)%14;if(p2===6)continue;s3--}return p2===13});pk=sm.length?sm[0]:(difficulty==="hard"?av.reduce((b,i)=>np[i]>np[b]?i:b,av[0]):av[Math.floor(Math.random()*av.length)])}const np2=[...np];let st2=np2[pk];np2[pk]=0;let ps2=pk;while(st2>0){ps2=(ps2+1)%14;if(ps2===6)continue;np2[ps2]++;st2--}if(ps2!==13&&ps2>=7&&ps2<=12&&np2[ps2]===1){const o=12-ps2;if(np2[o]>0){np2[13]+=np2[o]+1;np2[ps2]=0;np2[o]=0}}const sa=np2.slice(0,6).reduce((a,b)=>a+b,0),sb=np2.slice(7,13).reduce((a,b)=>a+b,0);if(sa===0||sb===0){np2[6]+=sa;np2[13]+=sb;for(let i=0;i<6;i++){np2[i]=0;np2[i+7]=0}sMsg(np2[6]>np2[13]?"You win! üéâ":np2[13]>np2[6]?"AI wins!":"Draw!");sS({p:np2,t:-1});return}sS({p:np2,t:ps2===13?1:0});sMsg(ps2===13?"AI extra turn":"Your turn");Au.place()},500)};const pt=(idx,act)=><div onClick={()=>act&&play(idx)} style={{width:48,height:48,borderRadius:"50%",background:act?"rgba(160,100,40,0.7)":"rgba(100,60,20,0.4)",border:"2px solid rgba(255,255,255,0.12)",display:"flex",alignItems:"center",justifyContent:"center",cursor:act?"pointer":"default",fontWeight:800,fontSize:"1.1rem",color:"#fff"}}>{s.p[idx]}</div>;return(<GW title="Mancala" onBack={onBack} bg="#2a1805"><div style={{display:"flex",flexDirection:"column",alignItems:"center",gap:12,paddingTop:16}}><p style={{fontWeight:700,color:msg.includes("win")?"#6bcb77":msg.includes("AI")?"#ff6b6b":"#ccc"}}>{msg}</p><div style={{display:"flex",gap:8,alignItems:"center",background:"rgba(120,70,20,0.2)",padding:18,borderRadius:24,border:"2px solid rgba(120,70,20,0.3)"}}><div style={{width:48,height:96,borderRadius:24,background:"rgba(120,70,20,0.5)",display:"flex",alignItems:"center",justifyContent:"center",fontWeight:900,fontSize:"1.5rem",color:"#ffd93d"}}>{s.p[13]}</div><div style={{display:"flex",flexDirection:"column",gap:10}}><div style={{display:"flex",gap:7}}>{[12,11,10,9,8,7].map(i=><div key={i}>{pt(i,false)}</div>)}</div><div style={{display:"flex",gap:7}}>{[0,1,2,3,4,5].map(i=><div key={i}>{pt(i,s.t===0)}</div>)}</div></div><div style={{width:48,height:96,borderRadius:24,background:"rgba(120,70,20,0.5)",display:"flex",alignItems:"center",justifyContent:"center",fontWeight:900,fontSize:"1.5rem",color:"#ffd93d"}}>{s.p[6]}</div></div><Btn onClick={()=>{sS(ini());sMsg("Your turn")}} color="#8B5A2B">New Game</Btn></div></GW>)}

// ==================== BACKGAMMON ====================
function Backgammon({onBack}){const[dice,sD]=useState([0,0]);const[msg,sM]=useState("Roll dice!");const roll=()=>{Au.click();const d=[Math.ceil(Math.random()*6),Math.ceil(Math.random()*6)];sD(d);sM("Rolled "+d[0]+" + "+d[1]+" = "+(d[0]+d[1]))};const b=useState(()=>{const a=Array(24).fill(null).map(()=>({w:0,b:0}));a[0].w=2;a[11].w=5;a[16].w=3;a[18].w=5;a[23].b=2;a[12].b=5;a[7].b=3;a[5].b=5;return a})[0];return(<GW title="Backgammon" onBack={onBack} bg="#1a1a05"><div style={{display:"flex",flexDirection:"column",alignItems:"center",gap:12,paddingTop:10}}><p style={{fontWeight:700}}>{msg}</p><div style={{display:"flex",gap:10}}>{dice.map((d,i)=><div key={i} style={{width:48,height:48,background:"#fff",borderRadius:10,display:"flex",alignItems:"center",justifyContent:"center",fontSize:"1.6rem",fontWeight:900,color:"#000"}}>{d||"?"}</div>)}</div><div style={{background:"linear-gradient(145deg,#6B3410,#4A2208)",padding:10,borderRadius:14,border:"4px solid #3a1a05"}}><div style={{display:"flex",gap:2}}>{b.slice(12,24).map((p,i)=><div key={i} style={{width:28,height:105,background:i%2===0?"#8B4513":"#D2B48C",borderRadius:"0 0 50% 50%",display:"flex",flexDirection:"column",alignItems:"center",paddingTop:4,gap:2}}>{Array(p.b).fill(0).map((_,j)=><div key={j} style={{width:20,height:20,borderRadius:"50%",background:"#333",border:"1px solid #666"}}/>)}{Array(p.w).fill(0).map((_,j)=><div key={j} style={{width:20,height:20,borderRadius:"50%",background:"#eee",border:"1px solid #aaa"}}/>)}</div>)}</div><div style={{height:14,background:"rgba(0,0,0,0.3)",margin:"2px 0",borderRadius:4}}/><div style={{display:"flex",gap:2}}>{b.slice(0,12).reverse().map((p,i)=><div key={i} style={{width:28,height:105,background:i%2===0?"#D2B48C":"#8B4513",borderRadius:"50% 50% 0 0",display:"flex",flexDirection:"column-reverse",alignItems:"center",paddingBottom:4,gap:2}}>{Array(p.w).fill(0).map((_,j)=><div key={j} style={{width:20,height:20,borderRadius:"50%",background:"#eee",border:"1px solid #aaa"}}/>)}{Array(p.b).fill(0).map((_,j)=><div key={j} style={{width:20,height:20,borderRadius:"50%",background:"#333",border:"1px solid #666"}}/>)}</div>)}</div></div><Btn onClick={roll} color="#8B4513" size="lg">üé≤ Roll Dice</Btn></div></GW>)}

// ==================== BINGO ====================
function Bingo({onBack,difficulty}){const gc=()=>Array(25).fill(0).map((_,i)=>{if(i===12)return{n:"‚òÖ",m:true};const c=i<12?Math.floor(i/5):Math.floor((i+1)/5);return{n:c*15+Math.floor(Math.random()*15)+1,m:false}});const[cd,sCd]=useState(gc);const[cl,sCl]=useState([]);const[cur,sCur]=useState(null);const[won,sWon]=useState(false);const clR=useRef([]);useEffect(()=>{clR.current=cl},[cl]);const auto=difficulty==="medium"||difficulty==="hard";const spd=difficulty==="medium"?4000:2000;const call=useCallback(()=>{const c=clR.current;const av=[];for(let i=1;i<=75;i++)if(!c.includes(i))av.push(i);if(!av.length)return;const n=av[Math.floor(Math.random()*av.length)];sCl(p=>[...p,n]);sCur(n);Au.click();sCd(prev=>prev.map(c2=>c2.n===n?{...c2,m:true}:c2))},[]);useEffect(()=>{if(!auto||won)return;const id=setInterval(call,spd);return()=>clearInterval(id)},[auto,spd,won,call]);useEffect(()=>{const ls=[[0,1,2,3,4],[5,6,7,8,9],[10,11,12,13,14],[15,16,17,18,19],[20,21,22,23,24],[0,5,10,15,20],[1,6,11,16,21],[2,7,12,17,22],[3,8,13,18,23],[4,9,14,19,24],[0,6,12,18,24],[4,8,12,16,20]];for(const l of ls){if(l.every(i=>cd[i].m)){sWon(true);Au.win();break}}},[cd]);return(<GW title="Bingo" onBack={onBack} bg="#1a0a2e"><div style={{display:"flex",flexDirection:"column",alignItems:"center",gap:12}}><div style={{fontSize:"2.2rem",fontWeight:900,color:"#ffd93d"}}>{cur?"BINGO"[Math.floor((cur-1)/15)]+" ‚Äî "+cur:"Press CALL!"}</div>{won&&<div style={{fontSize:"1.6rem",fontWeight:900,color:"#6bcb77"}}>üéâ BINGO! üéâ</div>}<div style={{display:"grid",gridTemplateColumns:"repeat(5,52px)",gap:4}}>{"BINGO".split("").map((l,i)=><div key={i} style={{textAlign:"center",fontWeight:900,fontSize:"1.2rem",color:"#4d96ff"}}>{l}</div>)}{cd.map((c,i)=><div key={i} onClick={()=>!won&&cl.includes(c.n)&&sCd(p=>p.map((cc,ii)=>ii===i?{...cc,m:true}:cc))} style={{width:52,height:52,display:"flex",alignItems:"center",justifyContent:"center",borderRadius:10,background:c.m?"linear-gradient(135deg,#6bcb77,#4a9e5a)":"rgba(255,255,255,0.06)",color:c.m?"#fff":"#aaa",fontWeight:800,cursor:"pointer",fontSize:c.n==="‚òÖ"?"1.3rem":"1rem",border:"1px solid "+(c.m?"rgba(107,203,119,0.3)":"rgba(255,255,255,0.08)"),transition:"all 0.2s"}}>{c.n}</div>)}</div><div style={{display:"flex",gap:8}}>{!auto&&<Btn onClick={call} color="#e85d75" size="lg">CALL!</Btn>}<Btn onClick={()=>{sCd(gc());sCl([]);clR.current=[];sCur(null);sWon(false)}}>New Card</Btn></div><p style={{color:"#556",fontSize:"0.75rem"}}>Called: {cl.slice(-8).join(", ")}{auto?" ¬∑ Auto "+spd/1000+"s":""}</p></div></GW>)}

// ==================== BOLTS ====================
function Bolts({onBack,difficulty}){const CL=["#ff6b6b","#4d96ff","#6bcb77","#ffd93d","#a855f7","#ff8800","#e85d75","#00bcd4"];const nc=difficulty==="easy"?3:difficulty==="medium"?4:5;const ini=()=>{const bs=[];for(let c=0;c<nc;c++)for(let i=0;i<3;i++)bs.push(c);for(let i=bs.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[bs[i],bs[j]]=[bs[j],bs[i]]}const sc=Array(nc+2).fill(null).map(()=>[]);let bi=0;for(let s=0;s<nc;s++)for(let i=0;i<3;i++)sc[s].push(bs[bi++]);return sc};const[sc,sSc]=useState(ini);const[sel,sSel]=useState(null);const[won,sWon]=useState(false);const[mv,sMv]=useState(0);const cl=i=>{if(won)return;if(sel===null){if(sc[i].length>0){sSel(i);Au.click()}}else{if(i===sel){sSel(null);return}const ns=sc.map(s=>[...s]);if(ns[sel].length>0&&ns[i].length<3){const b=ns[sel].pop();ns[i].push(b);sSc(ns);sSel(null);sMv(m=>m+1);Au.place();if(ns.every(s=>s.length===0||(s.length===3&&s.every(b2=>b2===s[0])))&&ns.filter(s=>s.length>0).length<=nc){sWon(true);Au.win()}}else sSel(null)}};return(<GW title="Bolts" onBack={onBack} score={mv+" moves"}><div style={{display:"flex",flexDirection:"column",alignItems:"center",gap:16,paddingTop:16,position:"relative"}}><div style={{display:"flex",gap:14,flexWrap:"wrap",justifyContent:"center"}}>{sc.map((s,i)=><div key={i} onClick={()=>cl(i)} style={{display:"flex",flexDirection:"column-reverse",alignItems:"center",gap:3,padding:10,borderRadius:14,background:sel===i?"rgba(255,215,0,0.15)":"rgba(255,255,255,0.04)",border:"2px solid "+(sel===i?"#ffd93d":"rgba(255,255,255,0.08)"),cursor:"pointer",minHeight:130,width:54}}><div style={{width:8,height:85,background:"linear-gradient(#777,#555)",borderRadius:4}}/>{s.map((b,j)=><div key={j} style={{width:38,height:16,background:CL[b],borderRadius:5,border:"1px solid rgba(255,255,255,0.2)",zIndex:1,marginBottom:-3}}/>)}</div>)}</div><Btn onClick={()=>{sSc(ini());sSel(null);sWon(false);sMv(0)}} color="#4d96ff">New Puzzle</Btn>{won&&<WN message={"Solved in "+mv+" moves!"} onReset={()=>{sSc(ini());sSel(null);sWon(false);sMv(0)}}/>}</div></GW>)}

// ==================== BLOCK BLAST ====================
function BlockBlast({onBack,difficulty}){const GS=difficulty==="easy"?6:difficulty==="medium"?8:10;const[gr,sGr]=useState(()=>Array(GS).fill(null).map(()=>Array(GS).fill(0)));const[sc,sSc]=useState(0);const[pcs,sPcs]=useState([]);const[drg,sDrg]=useState(null);const[go,sGo]=useState(false);const SH=[[[1]],[[1,1]],[[1],[1]],[[1,1],[1,1]],[[1,1,1]],[[1],[1],[1]],[[1,1],[1,0]],[[1,1],[0,1]],[[0,1],[1,1]],[[1,0],[1,1]],[[1,1,1],[0,0,1]],[[1,0,0],[1,1,1]],[[1,1,1,1]],[[1],[1],[1],[1]]];const CL=["#ff6b6b","#4d96ff","#6bcb77","#ffd93d","#a855f7","#ff8800","#e85d75","#00bcd4"];const gP=useCallback(()=>Array(3).fill(null).map(()=>({s:SH[Math.floor(Math.random()*SH.length)],c:CL[Math.floor(Math.random()*CL.length)]})),[]);useEffect(()=>{sPcs(gP())},[gP]);const cp=(g,s,r2,c2)=>{for(let r=0;r<s.length;r++)for(let c=0;c<s[r].length;c++){if(s[r][c]){const nr=r2+r,nc=c2+c;if(nr<0||nr>=GS||nc<0||nc>=GS||g[nr]?.[nc])return false}}return true};const pl=(pi,r2,c2)=>{const pc=pcs[pi];if(!pc||!cp(gr,pc.s,r2,c2))return;Au.place();const ng=gr.map(r=>[...r]);for(let r=0;r<pc.s.length;r++)for(let c=0;c<pc.s[r].length;c++){if(pc.s[r][c])ng[r2+r][c2+c]=pc.c}let cl=0;const rc=[],cc2=[];for(let r=0;r<GS;r++)if(ng[r].every(c=>c))rc.push(r);for(let c=0;c<GS;c++){let f=true;for(let r=0;r<GS;r++)if(!ng[r][c])f=false;if(f)cc2.push(c)}for(const r of rc){ng[r]=Array(GS).fill(0);cl++}for(const c of cc2){for(let r=0;r<GS;r++)ng[r][c]=0;cl++}if(cl)Au.score();sGr(ng);sSc(s=>s+cl*100+pc.s.flat().filter(v=>v).length*10);const np=[...pcs];np[pi]=null;const ce=(g2,ps)=>{for(const p of ps){if(!p)continue;for(let r=0;r<GS;r++)for(let c=0;c<GS;c++){if(cp(g2,p.s,r,c))return false}}return true};if(np.every(p=>!p)){const nw=gP();sPcs(nw);if(ce(ng,nw)){sGo(true);Au.lose()}}else{sPcs(np);if(ce(ng,np)){sGo(true);Au.lose()}}sDrg(null)};const cs=Math.min(36,Math.floor(320/GS));return(<GW title="Block Blast" onBack={onBack} score={sc}><div style={{display:"flex",flexDirection:"column",alignItems:"center",gap:12,position:"relative"}}><div style={{display:"grid",gridTemplateColumns:`repeat(${GS},${cs}px)`,gap:2,background:"rgba(255,255,255,0.03)",padding:4,borderRadius:10}}>{gr.flat().map((c,i)=>{const r=Math.floor(i/GS),co=i%GS;return<div key={i} onClick={()=>{if(drg!==null)pl(drg,r,co)}} style={{width:cs,height:cs,background:c||"rgba(255,255,255,0.02)",borderRadius:4,cursor:drg!==null?"pointer":"default"}}/>})}</div><div style={{display:"flex",gap:14,flexWrap:"wrap",justifyContent:"center"}}>{pcs.map((p,i)=>p?<div key={i} onClick={()=>sDrg(drg===i?null:i)} style={{padding:8,borderRadius:10,background:drg===i?"rgba(255,215,0,0.15)":"rgba(255,255,255,0.04)",border:"2px solid "+(drg===i?"#ffd93d":"transparent"),cursor:"pointer"}}>{p.s.map((r,ri)=><div key={ri} style={{display:"flex",gap:1}}>{r.map((c,ci)=><div key={ci} style={{width:18,height:18,background:c?p.c:"transparent",borderRadius:3}}/>)}</div>)}</div>:<div key={i} style={{width:50,height:50}}/>)}</div>{go&&<GO score={sc} onReset={()=>{sGr(Array(GS).fill(null).map(()=>Array(GS).fill(0)));sSc(0);sPcs(gP());sGo(false);sDrg(null)}} message="No moves!"/>}<p style={{color:"#445",fontSize:"0.75rem"}}>Select piece ‚Üí tap grid ¬∑ Fill rows/cols</p></div></GW>)}

// ==================== COLOR LINES ====================
function ColorLines({onBack,difficulty}){const GS=difficulty==="easy"?5:difficulty==="medium"?6:7;const nc=difficulty==="easy"?3:difficulty==="medium"?4:5;const CL=["#ff6b6b","#4d96ff","#6bcb77","#ffd93d","#a855f7"];const ini=()=>{const d=Array(GS).fill(null).map(()=>Array(GS).fill(null));for(let c=0;c<nc;c++){const ps=[];for(let r=0;r<GS;r++)for(let co=0;co<GS;co++){if(!d[r][co])ps.push([r,co])}for(let i=ps.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[ps[i],ps[j]]=[ps[j],ps[i]]}if(ps.length>=2){d[ps[0][0]][ps[0][1]]={c,e:true};d[ps[1][0]][ps[1][1]]={c,e:true}}}return d};const[dots,sDots]=useState(ini);const[paths,sPaths]=useState([]);const[dw,sDw]=useState(null);const[cp2,sCp]=useState([]);const[won,sWon]=useState(false);const cl=(r,c)=>{if(won)return;const d=dots[r]?.[c];if(dw===null){if(d?.e){sDw(d.c);sCp([{r,c}]);Au.click()}}else{if(d?.e&&d.c===dw&&cp2.length>1){sPaths(p=>{const np=[...p,{c:dw,cells:[...cp2,{r,c}]}];if(np.length===nc){sWon(true);Au.win()}return np});sDw(null);sCp([]);Au.score()}else{const l=cp2[cp2.length-1];if(!l)return;const dr=Math.abs(r-l.r),dc=Math.abs(c-l.c);if((dr===1&&dc===0)||(dr===0&&dc===1)){sCp(p=>[...p,{r,c}]);Au.click()}}}};const rs=()=>{sDots(ini());sPaths([]);sDw(null);sCp([]);sWon(false)};const pm=new Map();for(const p of paths)for(const c of p.cells)pm.set(c.r+","+c.c,CL[p.c]);for(const c of cp2)pm.set(c.r+","+c.c,CL[dw]+"55");const cs=Math.min(50,Math.floor(320/GS));return(<GW title="Color Lines" onBack={onBack}><div style={{display:"flex",flexDirection:"column",alignItems:"center",gap:12,paddingTop:16,position:"relative"}}><p style={{fontWeight:600,fontSize:"0.9rem",color:"#aaa"}}>{dw!==null?"Drawing...":paths.length+"/"+nc+" connected"}</p><div style={{display:"grid",gridTemplateColumns:`repeat(${GS},${cs}px)`,gap:3,background:"rgba(255,255,255,0.03)",padding:6,borderRadius:12}}>{Array(GS*GS).fill(0).map((_,i)=>{const r=Math.floor(i/GS),c=i%GS;const d=dots[r]?.[c];const pc=pm.get(r+","+c);return<div key={i} onClick={()=>cl(r,c)} style={{width:cs,height:cs,background:pc||"rgba(255,255,255,0.02)",borderRadius:8,display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",border:"1px solid rgba(255,255,255,0.05)"}}>{d?.e&&<div style={{width:cs*0.5,height:cs*0.5,borderRadius:"50%",background:CL[d.c],border:"3px solid rgba(255,255,255,0.5)"}}/>}</div>})}</div><div style={{display:"flex",gap:8}}><Btn onClick={()=>{sDw(null);sCp([])}}>Undo</Btn><Btn onClick={rs} color="#4d96ff">New Puzzle</Btn></div>{won&&<WN message="All connected!" onReset={rs}/>}</div></GW>)}

// ==================== UNO ====================
function Uno({onBack}){
  const CL=["red","blue","green","yellow"];const CC={red:"#e74c3c",blue:"#3498db",green:"#2ecc71",yellow:"#f1c40f"};
  const mkDeck=()=>{const d=[];for(const cl of CL){d.push({c:cl,v:0,t:"num"});for(let n=1;n<=9;n++){d.push({c:cl,v:n,t:"num"});d.push({c:cl,v:n,t:"num"})}for(const a of["skip","rev","d2"]){d.push({c:cl,v:a,t:"act"});d.push({c:cl,v:a,t:"act"})}};for(let i=0;i<4;i++){d.push({c:"wild",v:"w",t:"wild"});d.push({c:"wild",v:"wd4",t:"wild"})}for(let i=d.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[d[i],d[j]]=[d[j],d[i]]}return d};
  const ini=()=>{const dk=mkDeck();const h=[[],[],[],[]];for(let p=0;p<4;p++)for(let i=0;i<7;i++)h[p].push(dk.pop());let top=dk.pop();while(top.t==="wild"){dk.unshift(top);top=dk.pop()}return{dk,h,top,tp:0,dir:1,d2s:0,msg:"Your turn!",wc:null,ph:"play",won:null}};
  const[s,sS]=useState(ini);const[wcP,sWcP]=useState(false);
  const PN=["You","Bot 1","Bot 2","Bot 3"];const PE=["üòä","ü§ñ","ü¶ä","üêª"];
  const canP=(cd,top,wc)=>{if(cd.t==="wild")return true;const tc=wc||top.c;if(cd.c===tc)return true;if(cd.t==="num"&&top.t==="num"&&cd.v===top.v)return true;if(cd.t==="act"&&top.t==="act"&&cd.v===top.v)return true;return false};
  const doPlay=(st,pi,ci,wcl)=>{const ns={...st,h:st.h.map(h=>[...h]),dk:[...st.dk]};const cd=ns.h[pi][ci];ns.h[pi].splice(ci,1);if(cd.t==="wild"){ns.top={...cd,c:wcl||"red"};ns.wc=wcl||"red"}else{ns.top=cd;ns.wc=null}ns.msg=PN[pi]+" played "+(cd.t==="wild"?(cd.v==="wd4"?"Wild +4":"Wild"):cd.v);if(ns.h[pi].length===0){ns.won=pi;ns.msg=PN[pi]+(pi===0?" win!":" wins!");return ns}
    let np=(pi+ns.dir+4)%4;if(cd.v==="skip"){ns.msg+=", skip "+PN[np];np=(np+ns.dir+4)%4}else if(cd.v==="rev"){ns.dir*=-1;np=(pi+ns.dir+4)%4;ns.msg+=", reverse!"}else if(cd.v==="d2"){for(let i=0;i<2;i++){if(ns.dk.length)ns.h[np].push(ns.dk.pop())}ns.msg+=", "+PN[np]+" draws 2";np=(np+ns.dir+4)%4}else if(cd.v==="wd4"){for(let i=0;i<4;i++){if(ns.dk.length)ns.h[np].push(ns.dk.pop())}ns.msg+=", "+PN[np]+" draws 4";np=(np+ns.dir+4)%4}
    ns.tp=np;ns.ph="play";return ns};
  const draw=(st,pi)=>{const ns={...st,h:st.h.map(h=>[...h]),dk:[...st.dk]};if(ns.dk.length<1){const dd=mkDeck();ns.dk=dd}if(ns.dk.length){ns.h[pi].push(ns.dk.pop())}ns.msg=PN[pi]+" drew a card";ns.tp=(pi+ns.dir+4)%4;return ns};
  const botTurn=useCallback((st)=>{const pi=st.tp;const hand=st.h[pi];let best=-1;let bestS=-999;for(let i=0;i<hand.length;i++){if(canP(hand[i],st.top,st.wc)){let sc=0;if(hand[i].t==="wild")sc=hand[i].v==="wd4"?15:10;else if(hand[i].t==="act")sc=20;else sc=hand[i].v;if(sc>bestS){bestS=sc;best=i}}}
    if(best>=0){const cd=hand[best];let wcl=null;if(cd.t==="wild"){const cc={};for(const c2 of hand){if(c2.c!=="wild")cc[c2.c]=(cc[c2.c]||0)+1}let mx=0;wcl="red";for(const k in cc){if(cc[k]>mx){mx=cc[k];wcl=k}}};return doPlay(st,pi,best,wcl)}else{return draw(st,pi)}},[]);
  useEffect(()=>{if(s.won!==null||s.tp===0)return;const id=setTimeout(()=>{sS(prev=>{if(prev.won!==null||prev.tp===0)return prev;let ns=botTurn(prev);if(ns.won!==null){if(ns.won===0)Au.win();else Au.lose();return ns}while(ns.tp!==0&&ns.won===null){ns=botTurn(ns);if(ns.won!==null){if(ns.won===0)Au.win();else Au.lose()}}if(ns.tp===0)ns.msg+=" ‚Äî Your turn!";return ns})},600);return()=>clearTimeout(id)},[s.tp,s.won,botTurn]);
  const playCard=i=>{if(s.tp!==0||s.won!==null)return;const cd=s.h[0][i];if(!canP(cd,s.top,s.wc))return;Au.place();if(cd.t==="wild"){sWcP(i);return}sS(prev=>doPlay(prev,0,i,null))};
  const pickWild=cl=>{sWcP(false);sS(prev=>doPlay(prev,0,wcP,cl))};
  const drawCard=()=>{if(s.tp!==0||s.won!==null)return;Au.click();sS(prev=>{const ns=draw(prev,0);ns.tp=(0+ns.dir+4)%4;ns.msg="You drew. "+PN[ns.tp]+"'s turn";return ns})};
  const cdW=50,cdH=72;
  const Card=({cd,onClick,small,faceDown})=>{const bg=faceDown?"linear-gradient(135deg,#333,#555)":cd.c==="wild"?"linear-gradient(135deg,#e74c3c,#3498db,#2ecc71,#f1c40f)":`linear-gradient(135deg,${CC[cd.c]||"#666"},${CC[cd.c]||"#666"}dd)`;const w=small?36:cdW;const h=small?52:cdH;const lbl=faceDown?"":cd.t==="wild"?(cd.v==="wd4"?"+4":"W"):(cd.v==="skip"?"‚äò":cd.v==="rev"?"‚ü≤":cd.v==="d2"?"+2":cd.v);return<div onClick={onClick} style={{width:w,height:h,borderRadius:8,background:bg,border:"2px solid rgba(255,255,255,0.3)",display:"flex",alignItems:"center",justifyContent:"center",cursor:onClick?"pointer":"default",fontWeight:900,fontSize:small?"0.7rem":"1.1rem",color:"#fff",textShadow:"0 1px 3px rgba(0,0,0,0.5)",flexShrink:0,transition:"transform 0.15s",position:"relative"}}><span>{lbl}</span></div>};
  return(<GW title="Uno" onBack={onBack} bg="#1a0a2a"><div style={{display:"flex",flexDirection:"column",alignItems:"center",gap:10,paddingTop:8}}>
    <div style={{display:"flex",gap:20,justifyContent:"center",alignItems:"flex-start",flexWrap:"wrap"}}>
      {[1,2,3].map(pi=><div key={pi} style={{display:"flex",flexDirection:"column",alignItems:"center",gap:4}}><div style={{fontSize:"1.2rem"}}>{PE[pi]}</div><div style={{fontSize:"0.7rem",color:"#aaa",fontWeight:700}}>{PN[pi]}</div><div style={{display:"flex",gap:-8,justifyContent:"center"}}>{s.h[pi].slice(0,Math.min(s.h[pi].length,7)).map((_,j)=><div key={j} style={{marginLeft:j>0?-10:0}}><Card cd={{}} small faceDown/></div>)}</div><div style={{fontSize:"0.75rem",color:s.tp===pi?"#ffd93d":"#667",fontWeight:800}}>{s.h[pi].length} cards{s.tp===pi?" ‚è≥":""}</div></div>)}
    </div>
    <div style={{display:"flex",gap:16,alignItems:"center",padding:"8px 0"}}>
      <div onClick={drawCard} style={{cursor:s.tp===0?"pointer":"default",opacity:s.tp===0?1:0.4}}><Card cd={{}} faceDown/></div>
      <div style={{position:"relative"}}><Card cd={s.top}/>{s.wc&&<div style={{position:"absolute",bottom:-6,left:"50%",transform:"translateX(-50%)",width:14,height:14,borderRadius:"50%",background:CC[s.wc],border:"2px solid #fff"}}/>}</div>
    </div>
    <p style={{fontWeight:700,fontSize:"0.9rem",color:s.won===0?"#6bcb77":s.won!==null?"#ff6b6b":s.tp===0?"#ffd93d":"#888",textAlign:"center",minHeight:22}}>{s.msg}</p>
    {wcP!==false&&<div style={{display:"flex",gap:8,padding:"8px 0"}}>{CL.map(cl=><div key={cl} onClick={()=>pickWild(cl)} style={{width:40,height:40,borderRadius:"50%",background:CC[cl],cursor:"pointer",border:"3px solid #fff",display:"flex",alignItems:"center",justifyContent:"center",fontWeight:900,fontSize:"0.7rem",color:"#fff"}}>{cl[0].toUpperCase()}</div>)}</div>}
    <div style={{display:"flex",gap:4,flexWrap:"wrap",justifyContent:"center",maxWidth:420,padding:"4px 0"}}>
      {s.h[0].map((cd,i)=>{const ok=s.tp===0&&s.won===null&&canP(cd,s.top,s.wc);return<div key={i} style={{transform:ok?"translateY(-6px)":"none",transition:"transform 0.15s",opacity:ok?1:0.45}}><Card cd={cd} onClick={ok?()=>playCard(i):undefined}/></div>})}
    </div>
    <div style={{display:"flex",gap:8}}>
      {s.tp===0&&s.won===null&&<Btn onClick={drawCard} color="rgba(255,255,255,0.1)">Draw Card</Btn>}
      <Btn onClick={()=>{sS(ini());sWcP(false)}} color="#4d96ff">New Game</Btn>
    </div>
    {s.won!==null&&(s.won===0?<WN message="You win Uno!" onReset={()=>{sS(ini());sWcP(false)}}/>:<GO score={s.h[0].length+" cards left"} onReset={()=>{sS(ini());sWcP(false)}} message={PN[s.won]+" won!"}/>)}
  </div></GW>)}

// ==================== APP ====================
function App(){const[game,sGame]=useState("menu");const[pending,sPending]=useState(null);const[diff,sDiff]=useState("medium");const[gk,sGk]=useState(0);const sel=id=>{const g=GM.find(g=>g.id===id);if(g?.hd)sPending(id);else{sGame(id);sGk(k=>k+1)}};const ds=d=>{sDiff(d);sGame(pending);sPending(null);sGk(k=>k+1)};const back=()=>{sGame("menu");sPending(null)};if(pending)return<DiffSelect game={pending} onSelect={ds} onBack={()=>sPending(null)}/>;const p={onBack:back,difficulty:diff,key:game+"-"+diff+"-"+gk};switch(game){case"menu":return<Menu onSelect={sel}/>;case"tictactoe":return<TicTacToe {...p}/>;case"tictacgo":return<TicTacGo {...p}/>;case"pong":return<PongGame {...p}/>;case"pingpong":return<PingPong {...p}/>;case"tetris":return<Tetris {...p}/>;case"snake":return<SnakeGame {...p}/>;case"fall":return<FallGame {...p}/>;case"drop":return<DropGame {...p}/>;case"jump":return<JumpGame {...p}/>;case"baseball":return<Baseball {...p}/>;case"chess":return<Chess {...p}/>;case"checkers":return<Checkers {...p}/>;case"mancala":return<Mancala {...p}/>;case"backgammon":return<Backgammon {...p}/>;case"bingo":return<Bingo {...p}/>;case"pinball":return<PinballGame {...p}/>;case"bolts":return<Bolts {...p}/>;case"blockblast":return<BlockBlast {...p}/>;case"colorlines":return<ColorLines {...p}/>;case"uno":return<Uno {...p}/>;default:return<Menu onSelect={sel}/>}}
ReactDOM.createRoot(document.getElementById("root")).render(<App/>);
</script>
<script>
var c=document.getElementById('jsx-source').textContent;
var j=Babel.transform(c,{presets:['react']}).code;
(new Function(j))();
</script>
</body>
</html>
